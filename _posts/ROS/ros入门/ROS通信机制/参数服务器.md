---
layout: post
title: 参数服务器
date: 2023-08-01 10:00:00
description: 参数服务器
tags: ROS
categories: ROS
---

# 参数服务器

就是一个存放参数的容器，相当于全局变量的设置。

设置参数（c++）：

```c++
#include "ros/ros.h"

int main(int argc,char *argv[])
{
    ros::init(argc,argv,"setnode");
    ros::NodeHandle nh;

    nh.setParam("type","xiaohua");
    nh.setParam("radiu",0.5);
    nh.setParam("radiu",0.7);//可直接覆盖
    //ros::param::set()
    //另一种可用方法
    return 0;
}
```

获取&删除参数（c++）：

```c++
#include "ros/ros.h"

int main(int argc,char *argv[])
{
    setlocale(LC_ALL,"");
    ros::init(argc,argv,"param_get");
    ros::NodeHandle nh;

    double radiu=nh.param("radiu",0.5);
    ROS_INFO("radiu=%.2f",radiu);

    //  getParam(键,存储结果的变量)
    //         存在,返回 true,且将值赋值给参数2
    //         如果键不存在，那么返回值为 false，且不为参数2赋值
    //     getParamCached键(比getparam更高性能，功能相同)
    std::vector<std::string> names;
    nh.getParamNames(names); //遍历元素
    for (auto &&name : names)
    {
        ROS_INFO("遍历的元素为：%s",name.c_str());
    }
    //hasparam判断元素是否存在
    //serchparam(参数1，参数2)
    //        搜索键，参数1是被搜索的键，参数2存储搜索结果的变量
    bool flag;
    flag=nh.deleteParam("audiu");
    // deleteParam("键")
    //     根据键删除参数，删除成功，返回 true，否则(参数不存在)，返回 false
    
    return 0;
}
```

设置参数（python）：

```python
#! /usr/bin/env python
import rospy

if __name__ =="__main__":
    rospy.init_node("param_set")
    rospy.set_param("shuzi",10)
    rospy.set_param("xiaoshu",10.5)
    rospy.set_param("shuzi",10)
```

获取&删除参数（python）：

```python
#! /usr/bin/env python
import rospy

if __name__ =="__main__":
    rospy.init_node("param_get")

    int_value=rospy.get_param("shuzi")#获取键值
    double_value=rospy.get_param("xiaoshu")
    rospy.loginfo("intvalue=%d",int_value)
    rospy.loginfo("intvalue=%.2f",double_value)

    #rospy.get_param_cached()有缓存效率更高

    names=rospy.get_param_names()#获取所有元素
    for i in names:
        rospy.loginfo("name=%s",i)
    
    flag=rospy.has_param("shuzi")#判断是否包含某个键
    if(flag):
        rospy.loginfo("存在")

    shuzi=rospy.search_param("shuzi")#查找键
    rospy.loginfo("%s",shuzi)


    try:
        rospy.delete_param("shuzi")#删除键
    except Exception as e:
        rospy.loginfo("删除失败")
```
